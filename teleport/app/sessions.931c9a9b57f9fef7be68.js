"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[784],{9127:(e,t,r)=>{r.d(t,{tg:()=>o.Z,lo:()=>s.Z,d4:()=>n.useEffect,U7:()=>i,eJ:()=>n.useState});var n=r(2784),o=r(4851),s=r(4696);function i(e){const t=(0,n.useRef)();return(0,n.useEffect)((()=>{var r;e.shouldFocus&&(null===(r=t.current)||void 0===r||r.focus())}),[e.shouldFocus,t,...e.refocusDeps||[]]),t}},4851:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(2784);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=r(2418).Z.create("shared/hooks/useAttempt"),a={isProcessing:!1,isFailed:!1,isSuccess:!1,message:""};function l(e){const[t,r]=n.useState((()=>s(s({},a),e))),o=n.useMemo((()=>function(e){function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e(s(s({},a),{},{isSuccess:!0,message:t}))}function r(){e(s(s({},a),{},{isProcessing:!0}))}function n(t){c.error("attempt",t),e(s(s({},a),{},{isFailed:!0,message:t.message}))}return{do:function(e){try{return r(),e().then((()=>{t()})).catch((e=>{throw n(e),e}))}catch(e){n(e)}},stop:t,start:r,clear:function(){e(s({},a))},error:n}}(r)),[r]);return[t,o]}},6997:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var n=r(2784),o=r(7849),s=r(9124),i=r(7067),c=r(2398),a=r(6828),l=r(3652),u=r(8862),p=r(917),d=r(7278);const f={ssh:{icon:u.zlj,joinable:!0},k8s:{icon:u.YJo,joinable:!1},desktop:{icon:u.Hi7,joinable:!1},app:{icon:u.RKM,joinable:!1},db:{icon:u.voY,joinable:!1}},h=e=>{let{sid:t,clusterId:r,kind:s}=e;const{joinable:i}=f[s];if(!i)return n.createElement(l.bL,{align:"right",height:"26px"});const c=d.Z.getSshSessionRoute({sid:t,clusterId:r});return n.createElement(l.bL,{align:"right",height:"26px"},n.createElement(o.ku,{kind:"primary",as:"a",href:c,width:"80px",target:"_blank",size:"small"},"Join"))};function b(e){let{parties:t}=e;const r=t.map((e=>{let{user:t}=e;return`${t}`})).join(", ");return n.createElement(l.bL,null,r)}function g(e,t,r){if("parties"===r)return e.some((e=>e.user.toLocaleUpperCase().includes(t)))}const m=(0,p.ZP)(l.ZP)(["tbody > tr > td{vertical-align:middle;}"]),y=function(e){const{sessions:t,pageSize:r=100}=e;return n.createElement(m,{data:t,columns:[{key:"kind",headerText:"Type",isSortable:!0,render:e=>{let{kind:t}=e;return(e=>{const{icon:t}=f[e];return n.createElement(l.bL,null,n.createElement(u.ZPm,{p:1,mr:3,fontSize:3,as:t}))})(t)}},{key:"resourceName",headerText:"Name",isSortable:!0},{key:"sid",headerText:"Session ID"},{altKey:"users",headerText:"Users",render:b},{key:"durationText",altSortKey:"created",headerText:"Duration",isSortable:!0,onSort:(e,t)=>t-e},{altKey:"join-btn",render:h}],emptyText:"No Active Sessions Found",pagination:{pageSize:r},customSearchMatchers:[g],isSearchable:!0,initialSort:{altSortKey:"created",dir:"ASC"},searchableProps:["addr","sid","clusterId","resourceName","serverId","parties","durationText","login","created","parties"]})};var v=r(9127),x=r(695),O=r(9689);const P=x.g.getTracer("userSessions");function j(e){const{attempt:t,sessions:r}=e;return n.createElement(i.Ob,null,n.createElement(i.OX,{alignItems:"center"},n.createElement(i.u4,null,"Active Sessions")),t.isFailed&&n.createElement(s.b0,null,t.message," "),t.isProcessing&&n.createElement(o.xu,{textAlign:"center",m:10},n.createElement(o.z$,null)),t.isSuccess&&n.createElement(y,{sessions:r}))}const S=function(){const e=(0,c.Z)(),{clusterId:t}=(0,a.Z)(),r=function(e,t){const[r,o]=(0,n.useState)([]),[s,i]=(0,v.tg)({isProcessing:!0});return(0,n.useEffect)((()=>{i.do((()=>P.startActiveSpan("onRefresh",void 0,O.D.active(),(r=>e.sshService.fetchSessions(t).then((e=>(o(e),r.end(),e)))))))}),[t]),{attempt:s,sessions:r}}(e,t);return n.createElement(j,r)}},7067:(e,t,r)=>{r.d(t,{Ob:()=>p,OX:()=>l,u4:()=>u,E2:()=>d});var n=r(917),o=r(7849),s=r(135);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=(0,n.ZP)(o.kC)(["flex-shrink:0;border-bottom:1px solid ",";height:56px;margin-left:-40px;margin-right:-40px;padding-left:40px;padding-right:40px;"],(e=>e.theme.colors.primary.main));l.defaultProps={alignItems:"center",mb:4};const u=(0,n.ZP)(o.xv)(["white-space:nowrap;"]);u.defaultProps=c(c({},o.xv.defaultProps),{},{typography:"h3"});const p=(0,n.ZP)(o.kC)(["width:100%;height:100%;flex-direction:column;::after{content:' ';padding-bottom:24px;}"]);p.defaultProps={theme:s.Z,px:6},n.ZP.div(["position:absolute;width:100%;height:100%;display:flex;"]),n.ZP.div(["display:flex;flex-direction:column;width:100%;"]);const d=n.ZP.button(["color:",";cursor:pointer;display:inline-flex;font-size:14px;padding:12px 40px;position:relative;text-decoration:none;font-weight:500;&:hover{background:",";}&.active{color:",";}&.active:after{background-color:",";content:'';position:absolute;bottom:0;left:0;width:100%;height:4px;}"],(e=>e.theme.colors.text.secondary),(e=>e.active?e.theme.colors.primary.light:"rgba(255, 255, 255, .06)"),(e=>e.theme.colors.light),(e=>e.theme.colors.accent))},6828:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(4517),o=r(2784),s=r(7278);function i(){var e;const t=(0,o.useRef)({clusterId:s.Z.proxyCluster,hasClusterUrl:!1,isLeafCluster:!1}),r=(0,n.$B)(s.Z.routes.cluster),i=null==r||null===(e=r.params)||void 0===e?void 0:e.clusterId;return i&&(t.current.clusterId=i,t.current.isLeafCluster=i!==s.Z.proxyCluster),t.current.hasClusterUrl=!!i,t.current}},2398:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(2784),o=r(3665);function s(){const e=n.useContext(o.U);if(!e)throw new Error("Unable to retrieve Teleport Context");return window.teleContext=e}}}]);