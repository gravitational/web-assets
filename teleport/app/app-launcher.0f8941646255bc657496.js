"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[202],{4696:(t,e,r)=>{r.d(e,{Z:()=>a});var s=r(2784);const n=r(2418).Z.create("shared/hooks/useAttempt");function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const[e,r]=s.useState((()=>({status:t,statusText:""})));function a(t){n.error("attempt",t),r({status:"failed",statusText:t.message})}const c=(0,s.useCallback)((t=>{try{return r({status:"processing"}),t().then((()=>(r({status:"success"}),!0))).catch((t=>(a(t),!1)))}catch(t){return a(t),Promise.resolve(!1)}}),[]);return{attempt:e,setAttempt:r,run:c,handleError:a}}},8570:(t,e,r)=>{r.r(e),r.d(e,{default:()=>f});var s=r(2784),n=r(7849),a=r(8851),c=r(4517),o=r(4696),u=r(3022),l=r(1392);function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t){return"failed"===t.status?s.createElement(a.JK,{message:t.statusText}):s.createElement(n.kC,{height:"180px",justifyContent:"center",alignItems:"center",flex:"1"},s.createElement(n.z$,null))}const f=function(){const t=function(){const t=(0,c.UO)(),{attempt:e,setAttempt:r}=(0,o.Z)("processing");return s.useEffect((()=>{(function(t){const e=window.location,r=e.port?":"+e.port:"",s=(0,l.r)("state",e.search),n=(0,l.r)("awsrole",e.search),a=(0,l.r)("path",e.search);return s?(n&&(t.arn=n),u.Z.createAppSession(t).then((t=>{const e=new URL(`https://${t.fqdn}${r}/x-teleport-auth`);return e.searchParams.set("state",s),e.searchParams.append("subject",t.subject),e.hash=`#value=${t.value}`,a&&e.searchParams.set("path",a),e.toString()}))):u.Z.getAppFqdn(t).then((e=>{const s=new URL(`https://${e.fqdn}${r}/x-teleport-auth`);return t.clusterId&&s.searchParams.set("cluster",t.clusterId),t.publicAddr&&s.searchParams.set("addr",t.publicAddr),t.arn&&s.searchParams.set("awsrole",decodeURIComponent(t.arn)),a&&s.searchParams.set("path",a),s.toString()}))})(t).then((t=>{window.location.replace(t)})).catch((t=>{r({status:"failed",statusText:t.message})}))}),[]),function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e)}();return s.createElement(h,t)}}}]);