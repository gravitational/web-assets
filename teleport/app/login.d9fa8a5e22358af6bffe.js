"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[535],{1271:(e,t,r)=>{r.d(t,{Z:()=>d});var n=r(917),o=r(2784),a=r(7849),l=r(8197),i=r(7038);const s=["label","labelTip","value","options","onChange","placeholder","maxMenuHeight","isClearable","isMulti","menuPosition","rule","isSearchable","isSimpleValue","autoFocus","isDisabled"];function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(this,arguments)}const u=()=>()=>({valid:!0}),m=e=>{let{text:t}=e;return o.createElement(p,null,` - ${t}`)};var p=(0,n.ZP)("span")({fontWeight:"normal",textTransform:"none"});const d=function(e){let{label:t,labelTip:r,value:n,options:p,onChange:d,placeholder:h,maxMenuHeight:g,isClearable:b,isMulti:f,menuPosition:y,rule:E=u,isSearchable:v=!1,isSimpleValue:x=!1,autoFocus:w=!1,isDisabled:P=!1}=e,k=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,s);const{valid:O,message:Z}=(0,l.kQ)(E(n)),C=Boolean(!O),F=C?Z:t;return o.createElement(a.xu,c({mb:"4"},k),t&&o.createElement(a.SO,{htmlFor:"select",hasError:C},F,r&&o.createElement(m,{text:r})),o.createElement(i.ZP,{inputId:"select",menuPosition:y,hasError:C,isSimpleValue:x,isSearchable:v,isClearable:b,value:n,onChange:d,options:p,maxMenuHeight:g,placeholder:h,isMulti:f,autoFocus:w,isDisabled:P}))}},778:(e,t,r)=>{r.r(t),r.d(t,{LoginFailed:()=>c,default:()=>s});var n=r(2784),o=r(8851),a=r(7885),l=r(4116),i=r(7278);function s(){return n.createElement(a.rs,null,n.createElement(a.AW,{path:i.Z.routes.loginErrorCallback},n.createElement(c,{message:"unable to process callback"})),n.createElement(a.AW,{path:i.Z.routes.loginErrorUnauthorized},n.createElement(c,{message:"You are not authorized, please contact your SSO administrator."})),n.createElement(a.AW,{component:c}))}function c(e){let{message:t}=e;return n.createElement(n.Fragment,null,n.createElement(l.Z,null),n.createElement(o.Jz,{loginUrl:i.Z.routes.login,message:t||"unable to login, please check Teleport's log for details"}))}},402:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r(2784),o=r(7849),a=r(4116);function l(){return n.createElement(n.Fragment,null,n.createElement(a.Z,null),n.createElement(o.Pk,null))}},8998:(e,t,r)=>{r.r(t),r.d(t,{LoginFailed:()=>Y.default,LoginSuccess:()=>q.default,default:()=>J});var n=r(2784),o=r(917),a=r(7849),l=r(3757),i=r(9124),s=r(9127),c=r(8197),u=r(2030),m=r(1271),p=r(7097),d=r(9750),h=r(5081),g=r(2966),b=r(8227),f=r(9537);const y=["ssoType","title"];function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E.apply(this,arguments)}function v(e){switch(e.toLowerCase()){case"microsoft":return{color:"#2672ec",Icon:l.deu,type:e};case"github":return{color:"#444444",Icon:l.Eye,type:e};case"bitbucket":return{color:"#205081",Icon:l.Dzp,type:e};case"google":return{color:"#dd4b39",Icon:l.ieO,type:e};default:return{color:"#f7931e",Icon:l.mRU}}}const x=(0,o.ZP)(b.ZP)(["background-color:",";display:block;width:100%;border:1px solid transparent;&:hover,&:focus{background:",";border:1px solid ",";}height:40px;position:relative;box-sizing:border-box;","{font-size:20px;opacity:0.87;}"],(e=>e.color),(e=>(0,f._j)(e.color,.1)),(e=>(0,f.$n)(e.color,.4)),l.ZPm),w=o.ZP.div(["align-items:center;display:flex;justify-content:center;position:absolute;left:0;top:0;bottom:0;width:56px;font-size:24px;text-align:center;border-right:1px solid rgba(0,0,0,0.12);"]),P=e=>{const{ssoType:t="unknown",title:r}=e,o=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,y),{color:a,Icon:l}=v(t);return n.createElement(x,E({color:a,block:!0},o),Boolean(l)&&n.createElement(w,null,n.createElement(l,{"data-testid":"icon"})),r)},k=e=>{let{providers:t,prefixText:r,isDisabled:o,onClick:l,autoFocus:i=!1}=e;const s=t.map(((e,a)=>{let{name:s,type:c,displayName:u}=e;const m=u||`${r} ${s}`,p=function(){let e=arguments.length>1?arguments[1]:void 0;const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase();return-1!==t.indexOf("microsoft")?"microsoft":-1!==t.indexOf("bitbucket")?"bitbucket":-1!==t.indexOf("google")?"google":-1!==t.indexOf("github")||"github"===e?"github":"oidc"===e?"openid":"unknown"}(m,c),d=t.length-1;return n.createElement(P,{key:a,title:m,ssoType:p,disabled:o,mt:3,mb:a<d?3:0,autoFocus:0===a&&i,onClick:t=>{t.preventDefault(),l(e)}})}));return 0===s.length?n.createElement(a.xv,{textAlign:"center",bold:!0,pt:3},"You have no SSO providers configured"):n.createElement(a.xu,{px:6,pt:2,pb:2,"data-testid":"sso-list"},s)},O=["next","refCallback","hasTransitionEnded"],Z=["prev","refCallback"];function C(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function F(){return F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F.apply(this,arguments)}const S=e=>{let{attempt:t,authProviders:r,onLoginWithSso:o,autoFocus:a=!1}=e;const{isProcessing:l}=t;return n.createElement(k,{prefixText:"Login with",isDisabled:l,providers:r,onClick:o,autoFocus:a})},T=e=>{var t,r;let{onLoginWithWebauthn:o,attempt:s,autoFocus:c=!1}=e;const u=null===(t=window.navigator)||void 0===t||null===(r=t.userAgent)||void 0===r?void 0:r.toLowerCase().includes("firefox");return n.createElement(a.xu,{px:5,pt:2,"data-testid":"passwordless",pb:1},u&&n.createElement(i.kI,{mt:3},"Firefox may not support passwordless login. Please try Chrome or Safari."),n.createElement(j,{mt:3,py:2,px:3,width:"100%",onClick:()=>o(),disabled:s.isProcessing,autoFocus:c},n.createElement(a.kC,{alignItems:"center",justifyContent:"space-between"},n.createElement(a.kC,{alignItems:"center"},n.createElement(l.srI,{mr:3,fontSize:16}),n.createElement(a.xu,null,n.createElement(a.xv,{typography:"h6"},"Passwordless"),n.createElement(a.xv,{fontSize:1,color:"text.secondary"},"Follow the prompt from your browser"))),n.createElement(l.ZJY,{fontSize:16}))))},A=e=>{let{isRecoveryEnabled:t,onRecover:r,auth2faType:o,attempt:l,onLogin:i,onLoginWithWebauthn:h,clearAttempt:g,hasTransitionEnded:b,autoFocus:f=!1}=e;const{isProcessing:y}=l,[E,v]=(0,n.useState)(""),[x,w]=(0,n.useState)(""),[P,k]=(0,n.useState)(""),O=(0,n.useMemo)((()=>(0,d.Z)({auth2faType:o})),[]),Z=(0,s.U7)({shouldFocus:b&&f}),[C,F]=(0,n.useState)(O[0]);return n.createElement(c.ZP,null,(e=>{let{validator:l}=e;return n.createElement(a.kC,{as:"form",px:"5",pt:"3",justifyContent:"center",flexDirection:"column",borderBottomLeftRadius:"3",borderBottomRightRadius:"3","data-testid":"userpassword"},n.createElement(u.Z,{ref:Z,rule:(0,p.lp)("Username is required"),label:"Username",value:x,onChange:e=>w(e.target.value),placeholder:"Username",mb:3}),n.createElement(a.xu,{mb:t?1:3},n.createElement(u.Z,{rule:(0,p.lp)("Password is required"),label:"Password",value:E,onChange:e=>v(e.target.value),type:"password",placeholder:"Password",mb:0,width:"100%"}),t&&n.createElement(a.xu,{textAlign:"right"},n.createElement(a.ZP,{style:{padding:"0px",minHeight:0},onClick:()=>r(!0)},"Forgot Password?"))),"off"!==o&&n.createElement(a.xu,{mb:t?2:3},n.createElement(a.kC,{alignItems:"flex-end"},n.createElement(m.Z,{maxWidth:"50%",width:"100%","data-testid":"mfa-select",label:"Two-factor type",value:C,options:O,onChange:e=>function(e,t){k(""),g(),t.reset(),F(e)}(e,l),mr:3,mb:0,isDisabled:y,menuIsOpen:!0}),"otp"===C.value&&n.createElement(u.Z,{width:"50%",label:"Authenticator code",rule:p.Sb,autoComplete:"one-time-code",inputMode:"numeric",value:P,onChange:e=>k(e.target.value),placeholder:"123 456",mb:0})),t&&n.createElement(a.ZP,{style:{padding:"0px",minHeight:0},onClick:()=>r(!1)},"Lost Two-Factor Device?")),n.createElement(a.DF,{width:"100%",mt:3,mb:1,type:"submit",size:"large",onClick:e=>function(e,t){e.preventDefault(),t.validate()&&("webauthn"===(null==C?void 0:C.value)?h({username:x,password:E}):i(x,E,P))}(e,l),disabled:y},"Sign In"))}))},L=()=>n.createElement(a.kC,{alignItems:"center",justifyContent:"center",flexDirection:"column",borderBottom:1,borderColor:"text.placeholder",mx:5,mt:5,mb:2},n.createElement(W,null,"Or")),j=(0,o.ZP)(a.oD)(["display:block;text-align:left;border:1px solid ",";&:hover,&:active,&:focus{border-color:",";text-decoration:none;}&[disabled]{pointer-events:none;opacity:0.7;}"],(e=>{let{theme:t}=e;return t.colors.text.placeholder}),(e=>{let{theme:t}=e;return t.colors.action.active})),W=o.ZP.div(["background:",";display:flex;align-items:center;font-size:10px;height:32px;width:32px;justify-content:center;position:absolute;z-index:1;"],(e=>e.theme.colors.primary.light)),I={default:[e=>{var t;let{next:r,refCallback:o,hasTransitionEnded:l}=e,i=C(e,O);const s=(null===(t=i.authProviders)||void 0===t?void 0:t.length)>0;let c,u=!0;switch(i.primaryAuthType){case"passwordless":c=n.createElement(T,F({},i,{autoFocus:!0}));break;case"sso":c=n.createElement(S,F({},i,{autoFocus:!0}));break;case"local":u=i.isPasswordlessEnabled||s,c=n.createElement(A,F({},i,{hasTransitionEnded:l,autoFocus:!0}))}return n.createElement(a.xu,{ref:o},c,u&&n.createElement(a.xu,{pt:3,mt:-1,textAlign:"center"},n.createElement(a.oD,{disabled:i.attempt.isProcessing,onClick:()=>{i.clearAttempt(),r()}},"Other sign-in options")))},e=>{var t;let{prev:r,refCallback:o}=e,l=C(e,Z);const i=(null===(t=l.authProviders)||void 0===t?void 0:t.length)>0,{primaryAuthType:s,isPasswordlessEnabled:c}=l;let u;switch(s){case"passwordless":u=i?n.createElement(n.Fragment,null,n.createElement(S,F({},l,{autoFocus:!0})),n.createElement(L,null),n.createElement(A,l)):n.createElement(A,F({},l,{autoFocus:!0}));break;case"sso":u=c?n.createElement(n.Fragment,null,n.createElement(T,F({},l,{autoFocus:!0})),n.createElement(L,null),n.createElement(A,l)):n.createElement(A,F({},l,{autoFocus:!0}));break;case"local":u=c?n.createElement(n.Fragment,null,n.createElement(T,F({},l,{autoFocus:!0})),l.isPasswordlessEnabled&&i&&n.createElement(L,null),i&&n.createElement(S,l)):n.createElement(S,F({},l,{autoFocus:!0}))}return n.createElement(a.xu,{ref:o},u,n.createElement(a.xu,{pt:3,textAlign:"center"},n.createElement(a.oD,{disabled:l.attempt.isProcessing,onClick:()=>{l.clearAttempt(),r()}},"Back")))}]},D=function(e){const{title:t,attempt:r,isLocalAuthEnabled:o=!0,authProviders:l=[],privateKeyPolicyEnabled:s,isRecoveryEnabled:c,onRecover:u}=e;if(s)return n.createElement(g.n,{title:t,onRecover:c?u:null});const m=(null==l?void 0:l.length)>0;return!o&&m?n.createElement(a.Zb,{bg:"primary.light",my:"5",mx:"auto",width:"464px",pb:4},n.createElement(a.xv,{typography:"h3",pt:4,textAlign:"center",color:"light"},t),r.isFailed&&n.createElement(i.b0,{m:5,mb:0},r.message),n.createElement(S,e)):o?n.createElement(a.Zb,{bg:"primary.light",my:"5",mx:"auto",width:464,pb:4},n.createElement(a.xv,{typography:"h3",pt:4,textAlign:"center",color:"light"},t),r.isFailed&&n.createElement(i.b0,{m:5,mb:0},r.message),n.createElement(h.z,F({flows:I,currFlow:"default"},e))):n.createElement(a.Zb,{bg:"primary.light",my:"5",mx:"auto",width:"464px",px:5,pb:4},n.createElement(a.xv,{typography:"h3",pt:4,textAlign:"center",color:"light"},t),n.createElement(i.b0,{my:5},"Login has not been enabled"),n.createElement(a.xv,{mb:2,typography:"paragraph2",width:"100%"},"The ability to login has not been enabled. Please contact your system administrator for more information."))};var z=r(4116);const M=["hardware_key","hardware_key_touch"];function R(e){return M.some((t=>e.message.includes(t)))}var U=r(1392),_=r(7278),B=r(9376);function K(){const e=H();U.Z.push(e,!0)}function H(){let e=U.Z.getRedirectParam();return e=e?U.Z.ensureKnownRoute(e):_.Z.routes.root,U.Z.ensureBaseUrl(e)}const $=r(2010);function V(e){let{attempt:t,onLogin:r,onLoginWithWebauthn:o,onLoginWithSso:a,authProviders:l,auth2faType:i,preferredMfaType:s,isLocalAuthEnabled:c,clearAttempt:u,isPasswordlessEnabled:m,primaryAuthType:p,privateKeyPolicyEnabled:d}=e;return n.createElement(n.Fragment,null,n.createElement(z.Z,{src:$}),n.createElement(D,{title:"Sign in to Teleport",authProviders:l,auth2faType:i,preferredMfaType:s,isLocalAuthEnabled:c,onLoginWithSso:a,onLoginWithWebauthn:o,onLogin:r,attempt:t,clearAttempt:u,isPasswordlessEnabled:m,primaryAuthType:p,privateKeyPolicyEnabled:d}))}var Y=r(778),q=r(402);const J=function(){const e=function(){const[e,t]=(0,s.tg)({isProcessing:!1}),[r,o]=(0,n.useState)("none"!=_.Z.getPrivateKeyPolicy()),a=_.Z.getAuthProviders(),l=_.Z.getAuth2faType(),i=_.Z.getLocalAuthFlag();return{attempt:e,onLogin:function(e,r,n){t.start(),B.ZP.login(e,r,n).then(K).catch((e=>{R(e)?o(!0):t.error(e)}))},onLoginWithSso:function(e){t.start();const r=H(),n=_.Z.getSsoUrl(e.url,e.name,r);U.Z.push(n,!0)},authProviders:a,auth2faType:l,preferredMfaType:_.Z.getPreferredMfaType(),isLocalAuthEnabled:i,onLoginWithWebauthn:function(e){t.start(),B.ZP.loginWithWebauthn(e).then(K).catch((e=>{R(e)?o(!0):t.error(e)}))},clearAttempt:t.clear,isPasswordlessEnabled:_.Z.isPasswordlessEnabled(),primaryAuthType:_.Z.getPrimaryAuthType(),privateKeyPolicyEnabled:r}}();return n.createElement(V,e)}}}]);