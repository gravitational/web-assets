"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[426],{4221:(e,t,E)=>{E.d(t,{Z:()=>_});var S=E(2784),I=E(8069),n=E.n(I);E(8170),E(8074),E(6110),E(997);const s=E(917).ZP.div(["overflow:hidden;border-radius:4px;flex:1;display:flex;position:relative;border:none;background:",";.ace-monokai{background:",";}.ace-monokai .ace_gutter,.ace-monokai .ace_gutter-cell{color:rgba(255,255,255,0.56);background:",";}> .ace_editor{position:absolute;top:8px;right:0px;bottom:0px;left:0px;}"],(e=>e.theme.colors.bgTerminal),(e=>e.theme.colors.bgTerminal),(e=>e.theme.colors.bgTerminal)),{UndoManager:r}=n().require("ace/undomanager");class o extends S.Component{constructor(){var e,t;super(...arguments),t=()=>{const e=this.editor.session.getUndoManager().isClean();this.props.onDirty&&this.props.onDirty(!e);const t=this.editor.session.getValue();this.props.onChange&&this.props.onChange(t)},(e="onChange")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t}getData(){return this.sessions.map((e=>e.getValue()))}componentDidUpdate(e){e.activeIndex!==this.props.activeIndex&&this.setActiveSession(this.props.activeIndex),this.editor.resize()}createSession(e){let{content:t,type:E,tabSize:S=2}=e;const I="json"===E?"ace/mode/json":"ace/mode/yaml";let s=new(n().EditSession)(t),o=new r;return o.markClean(),s.setUndoManager(o),s.setUseWrapMode(!1),s.setOptions({tabSize:S,useSoftTabs:!0,useWorker:!1}),s.setMode(I),s}setActiveSession(e){let t=this.sessions[e];t||(t=this.createSession({content:""})),this.editor.setSession(t),this.editor.focus()}initSessions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.isDirty=!1,this.sessions=e.map((e=>this.createSession(e))),this.setActiveSession(0)}componentDidMount(){const{data:e,readOnly:t,theme:E="ace/theme/monokai"}=this.props;this.editor=n().edit(this.ace_viewer),this.editor.setFadeFoldWidgets(!0),this.editor.setWrapBehavioursEnabled(!0),this.editor.setHighlightActiveLine(!1),this.editor.setShowInvisibles(!1),this.editor.renderer.setShowGutter(!1),this.editor.renderer.setShowPrintMargin(!1),this.editor.renderer.setShowGutter(!0),this.editor.on("input",this.onChange),this.editor.setReadOnly(t),this.editor.setTheme(E),this.initSessions(e),this.editor.focus()}componentWillUnmount(){this.editor.destroy(),this.editor=null,this.session=null}render(){return S.createElement(s,null,S.createElement("div",{ref:e=>this.ace_viewer=e}))}}const _=o},8287:(e,t,E)=>{E.r(t),E.d(t,{default:()=>Y});var S=E(2784),I=E(9124),n=E(1218),s=E(4025),r=E(7067),o=E(2398),_=E(6828),i=E(3652),T=E(4217),a=E(3980),R=E.n(a),A=E(4221),c=E(9161);function l(e){const{event:t,onClose:E}=e,I=JSON.stringify(t.raw,null,2),s=t.codeDesc||"Event Details";return S.createElement(c.ZP,{dialogCss:D,disableEscapeKeyDown:!1,onClose:E,open:!0},S.createElement(c.fK,null,S.createElement(c.$N,{typography:"body1",caps:!0,bold:!0},s)),S.createElement(c.cZ,null,S.createElement(A.Z,{readOnly:!0,data:[{content:I,type:"json"}]})),S.createElement(c.cN,null,S.createElement(n.PL,{onClick:E},"Close")))}l.propTypes={event:R().object.isRequired,onClose:R().func.isRequired};const D=()=>"\n  min-height: 400px;\n  max-width: 600px;\n  width: 100%;\n",O=l;var C=E(917),L=E(8862),d=E(4133),h=E(7278);function N(){return N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var E=arguments[t];for(var S in E)Object.prototype.hasOwnProperty.call(E,S)&&(e[S]=E[S])}return e},N.apply(this,arguments)}const u={[d.I.AUTH_ATTEMPT_FAILURE]:L.kIV,[d.I.EXEC_FAILURE]:L.zlj,[d.I.EXEC]:L.zlj,[d.I.TRUSTED_CLUSTER_TOKEN_CREATED]:L.kIV,[d.I.TRUSTED_CLUSTER_CREATED]:L.kIV,[d.I.TRUSTED_CLUSTER_DELETED]:L.kIV,[d.I.GITHUB_CONNECTOR_CREATED]:L.kIV,[d.I.GITHUB_CONNECTOR_DELETED]:L.kIV,[d.I.OIDC_CONNECTOR_CREATED]:L.kIV,[d.I.OIDC_CONNECTOR_DELETED]:L.kIV,[d.I.SAML_CONNECTOR_CREATED]:L.kIV,[d.I.SAML_CONNECTOR_CREATED]:L.kIV,[d.I.SAML_CONNECTOR_DELETED]:L.kIV,[d.I.ROLE_CREATED]:L.kIV,[d.I.ROLE_DELETED]:L.kIV,[d.I.SCP_DOWNLOAD_FAILURE]:L.UWx,[d.I.SCP_DOWNLOAD]:L.UWx,[d.I.SCP_UPLOAD_FAILURE]:L.gqx,[d.I.SCP_UPLOAD]:L.gqx,[d.I.SFTP_OPEN_FAILURE]:L.GSs,[d.I.SFTP_OPEN]:L.GSs,[d.I.SFTP_CLOSE_FAILURE]:L.GSs,[d.I.SFTP_CLOSE]:L.GSs,[d.I.SFTP_READ_FAILURE]:L.GSs,[d.I.SFTP_READ]:L.GSs,[d.I.SFTP_WRITE_FAILURE]:L.GSs,[d.I.SFTP_WRITE]:L.GSs,[d.I.SFTP_LSTAT_FAILURE]:L.GSs,[d.I.SFTP_LSTAT]:L.GSs,[d.I.SFTP_FSTAT_FAILURE]:L.GSs,[d.I.SFTP_FSTAT]:L.GSs,[d.I.SFTP_SETSTAT_FAILURE]:L.GSs,[d.I.SFTP_SETSTAT]:L.GSs,[d.I.SFTP_FSETSTAT_FAILURE]:L.GSs,[d.I.SFTP_FSETSTAT]:L.GSs,[d.I.SFTP_OPENDIR_FAILURE]:L.GSs,[d.I.SFTP_OPENDIR]:L.GSs,[d.I.SFTP_READDIR_FAILURE]:L.GSs,[d.I.SFTP_READDIR]:L.GSs,[d.I.SFTP_REMOVE_FAILURE]:L.GSs,[d.I.SFTP_REMOVE]:L.GSs,[d.I.SFTP_MKDIR_FAILURE]:L.GSs,[d.I.SFTP_MKDIR]:L.GSs,[d.I.SFTP_RMDIR_FAILURE]:L.GSs,[d.I.SFTP_RMDIR]:L.GSs,[d.I.SFTP_REALPATH_FAILURE]:L.GSs,[d.I.SFTP_REALPATH]:L.GSs,[d.I.SFTP_STAT_FAILURE]:L.GSs,[d.I.SFTP_STAT]:L.GSs,[d.I.SFTP_RENAME_FAILURE]:L.GSs,[d.I.SFTP_RENAME]:L.GSs,[d.I.SFTP_READLINK_FAILURE]:L.GSs,[d.I.SFTP_READLINK]:L.GSs,[d.I.SFTP_SYMLINK_FAILURE]:L.GSs,[d.I.SFTP_SYMLINK]:L.GSs,[d.I.APP_SESSION_CHUNK]:L.kIV,[d.I.APP_SESSION_START]:L.kIV,[d.I.APP_SESSION_END]:L.kIV,[d.I.APP_SESSION_DYNAMODB_REQUEST]:L.voY,[d.I.APP_CREATED]:L.EKh,[d.I.APP_UPDATED]:L.EKh,[d.I.APP_DELETED]:L.EKh,[d.I.SESSION_END]:L.zlj,[d.I.SESSION_JOIN]:L.zlj,[d.I.SESSION_LEAVE]:L.zlj,[d.I.SESSION_START]:L.zlj,[d.I.SESSION_UPLOAD]:L.zlj,[d.I.SESSION_REJECT]:L.zlj,[d.I.TERMINAL_RESIZE]:L.zlj,[d.I.SESSION_DATA]:L.zlj,[d.I.SESSION_NETWORK]:L.zlj,[d.I.SESSION_DISK]:L.zlj,[d.I.SESSION_COMMAND]:L.zlj,[d.I.SESSION_PROCESS_EXIT]:L.zlj,[d.I.SESSION_CONNECT]:L.zlj,[d.I.USER_CREATED]:L.kIV,[d.I.USER_UPDATED]:L.kIV,[d.I.USER_DELETED]:L.kIV,[d.I.RESET_PASSWORD_TOKEN_CREATED]:L.kIV,[d.I.USER_PASSWORD_CHANGED]:L.kIV,[d.I.ACCESS_REQUEST_CREATED]:L.kIV,[d.I.ACCESS_REQUEST_UPDATED]:L.kIV,[d.I.ACCESS_REQUEST_REVIEWED]:L.kIV,[d.I.ACCESS_REQUEST_DELETED]:L.kIV,[d.I.ACCESS_REQUEST_RESOURCE_SEARCH]:L.kIV,[d.I.USER_LOCAL_LOGIN]:L.kIV,[d.I.USER_LOCAL_LOGINFAILURE]:L.kIV,[d.I.USER_SSO_LOGIN]:L.kIV,[d.I.USER_SSO_LOGINFAILURE]:L.kIV,[d.I.USER_SSO_TEST_FLOW_LOGIN]:L.kIV,[d.I.USER_SSO_TEST_FLOW_LOGINFAILURE]:L.kIV,[d.I.KUBE_REQUEST]:L.YJo,[d.I.KUBE_CREATED]:L.YJo,[d.I.KUBE_UPDATED]:L.YJo,[d.I.KUBE_DELETED]:L.YJo,[d.I.DATABASE_SESSION_STARTED]:L.voY,[d.I.DATABASE_SESSION_STARTED_FAILURE]:L.voY,[d.I.DATABASE_SESSION_ENDED]:L.voY,[d.I.DATABASE_SESSION_QUERY]:L.voY,[d.I.DATABASE_SESSION_QUERY_FAILURE]:L.voY,[d.I.DATABASE_SESSION_MALFORMED_PACKET]:L.voY,[d.I.DATABASE_CREATED]:L.voY,[d.I.DATABASE_UPDATED]:L.voY,[d.I.DATABASE_DELETED]:L.voY,[d.I.POSTGRES_PARSE]:L.voY,[d.I.POSTGRES_BIND]:L.voY,[d.I.POSTGRES_EXECUTE]:L.voY,[d.I.POSTGRES_CLOSE]:L.voY,[d.I.POSTGRES_FUNCTION_CALL]:L.voY,[d.I.MYSQL_STATEMENT_PREPARE]:L.voY,[d.I.MYSQL_STATEMENT_EXECUTE]:L.voY,[d.I.MYSQL_STATEMENT_SEND_LONG_DATA]:L.voY,[d.I.MYSQL_STATEMENT_CLOSE]:L.voY,[d.I.MYSQL_STATEMENT_RESET]:L.voY,[d.I.MYSQL_STATEMENT_FETCH]:L.voY,[d.I.MYSQL_STATEMENT_BULK_EXECUTE]:L.voY,[d.I.MYSQL_INIT_DB]:L.voY,[d.I.MYSQL_CREATE_DB]:L.voY,[d.I.MYSQL_DROP_DB]:L.voY,[d.I.MYSQL_SHUT_DOWN]:L.voY,[d.I.MYSQL_PROCESS_KILL]:L.voY,[d.I.MYSQL_DEBUG]:L.voY,[d.I.MYSQL_REFRESH]:L.voY,[d.I.SQLSERVER_RPC_REQUEST]:L.voY,[d.I.CASSANDRA_BATCH_EVENT]:L.voY,[d.I.CASSANDRA_EXECUTE_EVENT]:L.voY,[d.I.CASSANDRA_PREPARE_EVENT]:L.voY,[d.I.CASSANDRA_REGISTER_EVENT]:L.voY,[d.I.ELASTICSEARCH_REQUEST]:L.voY,[d.I.DYNAMODB_REQUEST]:L.voY,[d.I.DYNAMODB_REQUEST_FAILURE]:L.voY,[d.I.DESKTOP_SESSION_STARTED]:L.Hi7,[d.I.DESKTOP_SESSION_STARTED_FAILED]:L.Hi7,[d.I.DESKTOP_SESSION_ENDED]:L.Hi7,[d.I.DESKTOP_CLIPBOARD_SEND]:L.TUt,[d.I.DESKTOP_CLIPBOARD_RECEIVE]:L.TUt,[d.I.DESKTOP_SHARED_DIRECTORY_START]:L.ot9,[d.I.DESKTOP_SHARED_DIRECTORY_START_FAILURE]:L.ot9,[d.I.DESKTOP_SHARED_DIRECTORY_READ]:L.ot9,[d.I.DESKTOP_SHARED_DIRECTORY_READ_FAILURE]:L.ot9,[d.I.DESKTOP_SHARED_DIRECTORY_WRITE]:L.ot9,[d.I.DESKTOP_SHARED_DIRECTORY_WRITE_FAILURE]:L.ot9,[d.I.DEVICE_AUTHENTICATE]:L.kIV,[d.I.DEVICE_CREATE]:L.kIV,[d.I.DEVICE_DELETE]:L.kIV,[d.I.DEVICE_ENROLL]:L.kIV,[d.I.DEVICE_ENROLL_TOKEN_CREATE]:L.kIV,[d.I.DEVICE_ENROLL_TOKEN_SPENT]:L.kIV,[d.I.MFA_DEVICE_ADD]:L.kIV,[d.I.MFA_DEVICE_DELETE]:L.kIV,[d.I.BILLING_CARD_CREATE]:L.Qyo,[d.I.BILLING_CARD_DELETE]:L.Qyo,[d.I.BILLING_CARD_UPDATE]:L.Qyo,[d.I.BILLING_INFORMATION_UPDATE]:L.Qyo,[d.I.CLIENT_DISCONNECT]:L.kIV,[d.I.PORTFORWARD]:L.kIV,[d.I.PORTFORWARD_FAILURE]:L.kIV,[d.I.SUBSYSTEM]:L.kIV,[d.I.SUBSYSTEM_FAILURE]:L.kIV,[d.I.LOCK_CREATED]:L.HEZ,[d.I.LOCK_DELETED]:L.Slr,[d.I.RECOVERY_TOKEN_CREATED]:L.kIV,[d.I.RECOVERY_CODE_GENERATED]:L.RGo,[d.I.RECOVERY_CODE_USED]:L.s2m,[d.I.RECOVERY_CODE_USED_FAILURE]:L.s2m,[d.I.PRIVILEGE_TOKEN_CREATED]:L.kIV,[d.I.X11_FORWARD]:L.kIV,[d.I.X11_FORWARD_FAILURE]:L.kIV,[d.I.CERTIFICATE_CREATED]:L.RGo,[d.I.UPGRADE_WINDOW_UPDATED]:L.kIV,[d.I.SESSION_RECORDING_ACCESS]:L.kIV,[d.I.SSMRUN_SUCCESS]:L.kIV,[d.I.SSMRUN_FAIL]:L.kIV,[d.I.BOT_JOIN]:L.kIV,[d.I.INSTANCE_JOIN]:L.kIV,[d.I.UNKNOWN]:L.HNF},P=(0,C.ZP)(L.zlj)((e=>`\n  background: ${e.theme.colors.dark};\n  border: 2px solid ${e.theme.colors.accent};\n  color: ${e.theme.colors.text.primary};\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  padding: 0;\n  border-radius: 100px;\n  transition: all 0.3s;\n\n  &:hover,\n  &:active,\n  &:focus {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.24);\n    color: ${e.theme.colors.light};\n  }\n\n  &:active {\n    box-shadow: none;\n    opacity: 0.56;\n  }\n`)),U=C.ZP.div(["display:flex;align-items:center;min-width:130px;font-size:12px;font-weight:500;line-height:24px;white-space:nowrap;"]),p=e=>{let{time:t}=e;return S.createElement(i.bL,{style:{minWidth:"120px"}},t)};function m(e){let{message:t}=e;return S.createElement(i.bL,{style:{wordBreak:"break-word"}},t)}const F=function(e){const{clusterId:t,events:E=[],fetchMore:I,fetchStatus:s,pageSize:r=50}=e,[o,_]=(0,S.useState)();return S.createElement(S.Fragment,null,S.createElement(i.ZP,{data:E,columns:[{key:"codeDesc",headerText:"Type",isSortable:!0,render:e=>function(e,t){const E=u[e.code]||L.aVo,I={p:"1",mr:"3",fontSize:"3"};return e.code===d.I.SESSION_END&&e.raw.interactive&&"off"!==e.raw.session_recording?S.createElement(i.bL,{style:{verticalAlign:"inherit"}},S.createElement(U,null,S.createElement("a",{title:"Open Session Player",href:h.Z.getPlayerRoute({clusterId:t,sid:e.raw.sid},{recordingType:"ssh"}),target:"_blank",style:{textDecoration:"none"}},S.createElement(P,I)),e.codeDesc)):S.createElement(i.bL,{style:{verticalAlign:"inherit"}},S.createElement(U,null,S.createElement(L.ZPm,N({},I,{as:E})),e.codeDesc))}(e,t)},{key:"message",headerText:"Description",render:m},{key:"time",headerText:"Created (UTC)",isSortable:!0,render:p},{altKey:"show-details-btn",render:e=>((e,t)=>S.createElement(i.bL,{align:"right"},S.createElement(n.ku,{size:"small",onClick:()=>t(e),width:"87px"},"Details")))(e,_)}],emptyText:"No Events Found",isSearchable:!0,searchableProps:["code","codeDesc","time","user","message","id"],customSearchMatchers:[(0,T.vq)(["time"])],initialSort:{key:"time",dir:"DESC"},pagination:{pageSize:r},fetching:{onFetchMore:I,fetchStatus:s}}),o&&S.createElement(O,{event:o,onClose:()=>_(null)}))};var v=E(4696);function g(e,t){var E=Object.keys(e);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(e);t&&(S=S.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),E.push.apply(E,S)}return E}function k(e){for(var t=1;t<arguments.length;t++){var E=null!=arguments[t]?arguments[t]:{};t%2?g(Object(E),!0).forEach((function(t){V(e,t,E[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(E)):g(Object(E)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(E,t))}))}return e}function V(e,t,E){return t in e?Object.defineProperty(e,t,{value:E,enumerable:!0,configurable:!0,writable:!0}):e[t]=E,e}function f(e){const{attempt:t,range:E,setRange:o,rangeOptions:_,events:i,clusterId:T,fetchMore:a,fetchStatus:R}=e;return S.createElement(r.Ob,null,S.createElement(r.OX,{alignItems:"center"},S.createElement(r.u4,{mr:"8"},"Audit Log"),S.createElement(s.Z,{ml:"auto",range:E,ranges:_,onChangeRange:o})),"failed"===t.status&&S.createElement(I.b0,null," ",t.statusText," "),"processing"===t.status&&S.createElement(n.xu,{textAlign:"center",m:10},S.createElement(n.z$,null)),"success"===t.status&&S.createElement(F,{events:i,clusterId:T,fetchMore:a,fetchStatus:R}))}const Y=function(){const e=(0,o.Z)(),{clusterId:t}=(0,_.Z)(),E=function(e,t,E){const I=(0,S.useMemo)((()=>(0,s.n)()),[]),[n,r]=(0,S.useState)(I[0]),{attempt:o,setAttempt:_,run:i}=(0,v.Z)("processing"),[T,a]=(0,S.useState)({events:[],fetchStartKey:"",fetchStatus:""}),R=E?d.$0[E].type:"";return(0,S.useEffect)((()=>{i((()=>e.auditService.fetchEvents(t,k(k({},n),{},{filterBy:R})).then((e=>a({events:e.events,fetchStartKey:e.startKey,fetchStatus:e.startKey?"":"disabled"})))))}),[t,n]),k(k({},T),{},{fetchMore:function(){a(k(k({},T),{},{fetchStatus:"loading"})),e.auditService.fetchEvents(t,k(k({},n),{},{filterBy:R,startKey:T.fetchStartKey})).then((e=>a({events:[...T.events,...e.events],fetchStartKey:e.startKey,fetchStatus:e.startKey?"":"disabled"}))).catch((e=>{_({status:"failed",statusText:e.message})}))},clusterId:t,attempt:o,range:n,setRange:r,rangeOptions:I})}(e,t);return S.createElement(f,E)}}}]);