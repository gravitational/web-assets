"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[65],{4696:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(2784);const s=r(2418).Z.create("shared/hooks/useAttempt");function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const[t,r]=n.useState((()=>({status:e,statusText:""})));function o(e){s.error("attempt",e),r({status:"failed",statusText:e.message})}const a=(0,n.useCallback)((e=>{try{return r({status:"processing"}),e().then((()=>(r({status:"success"}),!0))).catch((e=>(o(e),!1)))}catch(e){return o(e),Promise.resolve(!1)}}),[]);return{attempt:t,setAttempt:r,run:a,handleError:o}}},9939:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var n=r(2784),s=r(9124),o=r(1218),a=r(6961),l=r(9049),c=r(7067),i=r(694),u=r(2682),m=r(9127),d=r(369);const p=function(e){const{name:t,onClose:r,onDelete:a}=e,[l,c]=(0,m.tg)({isProcessing:!1}),i=l.isProcessing;return n.createElement(d.ZP,{disableEscapeKeyDown:!1,onClose:r,open:!0},n.createElement(d.fK,null,n.createElement(d.$N,null,"Remove Trusted Cluster?")),n.createElement(d.cZ,{width:"540px"},l.isFailed&&n.createElement(s.b0,null,l.message),n.createElement(o.xv,{typography:"paragraph",mb:"6"},"Are you sure you want to delete trusted cluster"," ",n.createElement(o.xv,{as:"span",bold:!0,color:"primary.contrastText"},t),"?")),n.createElement(d.cN,null,n.createElement(o.U3,{mr:"3",disabled:i,onClick:function(){c.do((()=>a())).then((()=>r()))}},"Yes, Remove Trusted Cluster"),n.createElement(o.PL,{disabled:i,onClick:r},"Cancel")))},h={trusted_cluster:"#\n# Example resource for a trusted cluster with RBAC\n#\n# IMPORTANT: only one field (enabled) can be changed after a cluster is created.\n#\nkind: trusted_cluster\nversion: v2\nmetadata:\n  # the trusted cluster name MUST match the 'cluster_name' setting of the root cluster.\n  name: name-of-root-cluster\nspec:\n  # this field allows to create tunnels that are disabled, but can be enabled later.\n  # this is the only field that can be changed later.\n  enabled: true\n  # the token expected by the \"root\" cluster:\n  # This can be a static token from the root cluster https://goteleport.com/docs/trustedclusters/#static-join-tokens\n  # or a dynamic token generated by the root cluster https://goteleport.com/docs/trustedclusters/#dynamic-join-tokens\n  token: secret-token-from-root-cluster\n  # the address in 'host:port' form of the reverse tunnel listening port on the\n  # \"root\" proxy server:\n  tunnel_addr: root-proxy.example.com:3024\n  # the address in 'host:port' form of the web listening port on the\n  # \"root\" proxy server:\n  web_proxy_addr: root-proxy.example.com:443\n  # RBAC for trusted clusters: it says that the users who have the role 'access'\n  # on a root cluster will be mapped to the local role 'guest'\n  role_map:\n  - local: [guest]\n    remote: access\n"};var f=r(3757),b=r(3937);const g=["name","id","onEdit","onDelete"];function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(this,arguments)}function E(e){const{name:t,id:r,onEdit:s,onDelete:a}=e,l=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,g);return n.createElement(o.kC,y({style:{position:"relative",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.24)"},width:"240px",height:"240px",borderRadius:"3",flexDirection:"column",alignItems:"center",justifyContent:"center",bg:"primary.light",px:"5",pt:"4",pb:"5"},l),n.createElement(o.kC,{width:"100%",justifyContent:"center"},n.createElement(b.Oq,{buttonIconProps:x},n.createElement(b.sN,{onClick:()=>a(r)},"Delete..."))),n.createElement(o.kC,{flex:"1",mb:"3",alignItems:"center",justifyContent:"center",flexDirection:"column"},n.createElement(f.OGY,{my:"4",style:{textAlign:"center"},fontSize:"48px",color:"text.primary"}),n.createElement(o.xv,{typography:"p",bold:!0,caps:!0,mb:"1",textAlign:"center",title:t,style:{width:"200px"}},t)),n.createElement(o.DF,{mt:"auto",px:"1",size:"medium",block:!0,onClick:()=>s(r)},"EDIT TRUSTED CLUSTER"))}const x={style:{right:"10px",position:"absolute",top:"10px"}},v=["items","onEdit","onDelete"];function C(){return C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C.apply(this,arguments)}const O=function(e){let{items:t,onEdit:r,onDelete:s}=e,a=function(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,v);t=t||[];const l=t.map((e=>{const{id:t,name:o,kind:a}=e;return n.createElement(E,{mb:4,mr:5,key:t,id:t,onEdit:r,onDelete:s,name:o,kind:a})}));return n.createElement(o.kC,C({flexWrap:"wrap",alignItems:"center"},a),l)};var w=r(2398);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const T=r.p+"assets/img/img-2a6939.png",P=e=>n.createElement(o.xu,e,n.createElement(o.xv,{typography:"h6",mb:3},"TRUSTED CLUSTERS"),n.createElement(o.xv,{typography:"subtitle1",mb:3},"Trusted Clusters allow Teleport administrators to connect multiple clusters together and establish trust between them. Users of Trusted Clusters can seamlessly access the nodes of the cluster from the root cluster."),n.createElement(o.xv,{typography:"subtitle1",mb:2},"Please"," ",n.createElement(o.rU,{color:"light",href:"https://goteleport.com/docs/setup/admin/trustedclusters/",target:"_blank"},"view our documentation")," ","to learn more about Trusted Clusters.")),S=e=>n.createElement(a.Z,{maxWidth:"700px",mt:4,mx:"auto",py:4,as:o.kC,alignItems:"center",flex:"0 0 auto"},n.createElement(o.xu,{mx:"4"},n.createElement(l.Z,{width:"180px",src:T})),n.createElement(o.xu,null,n.createElement(P,{pr:4,mb:6}),n.createElement(o.DF,{disabled:e.disabled,title:e.disabled?"You do not have access to add a trusted cluster":"",onClick:e.onCreate,mb:"2",mx:"auto",width:"240px"},"Connect to Root Cluster"))),D=function(){const e=function(){const e=(0,w.Z)(),[t,r]=(0,m.eJ)([]),[n,s]=(0,m.tg)({isProcessing:!0}),o=e.storeUser.getTrustedClusterAccess().create;function a(){return e.resourceService.fetchTrustedClusters().then((e=>{r(e)}))}return(0,m.d4)((()=>{s.do((()=>a()))}),[]),function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({canCreate:o,items:t,save:function(t,r){return r?e.resourceService.createTrustedCluster(t).then(a):e.resourceService.updateTrustedCluster(t).then(a)},remove:function(n){return e.resourceService.deleteTrustedCluster(n).then((()=>{r(t.filter((e=>e.name!==n)))}))}},n)}(),t=e.isSuccess&&0===e.items.length,r=e.isSuccess&&e.items.length>0,a=(0,u.Z)(e.items,h),l="creating"===a.status?"Add a new trusted cluster":"Edit trusted cluster";return n.createElement(c.Ob,null,n.createElement(c.OX,{alignItems:"center"},n.createElement(c.u4,null,"Trusted Clusters"),r&&n.createElement(o.DF,{disabled:!e.canCreate,ml:"auto",width:"240px",onClick:()=>a.create("trusted_cluster")},"Connect to Root Cluster")),e.isFailed&&n.createElement(s.b0,null,e.message," "),e.isProcessing&&n.createElement(o.xu,{textAlign:"center",m:10},n.createElement(o.z$,null)),t&&n.createElement(S,{disabled:!e.canCreate,onCreate:()=>a.create("trusted_cluster")}),r&&n.createElement(o.kC,{alignItems:"start"},n.createElement(O,{mt:"4",flex:"1",items:e.items,onEdit:a.edit,onDelete:a.remove}),n.createElement(P,{ml:"4",width:"240px",color:"text.primary",style:{flexShrink:0}})),("creating"===a.status||"editing"===a.status)&&n.createElement(i.Z,{onSave:function(t){const r="creating"===a.status;return e.save(t,r)},title:l,onClose:a.disregard,text:a.item.content,name:a.item.name,isNew:"creating"===a.status}),"removing"===a.status&&n.createElement(p,{name:a.item.name,onClose:a.disregard,onDelete:function(){return e.remove(a.item.name)}}))}}}]);