"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[465],{1051:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var n=r(2784),a=r(9124),s=r(7849),c=r(4025),o=r(7067),i=r(2398),l=r(3652),u=r(4217),d=r(8862),g=r(7278);function f(e){const{recordings:t=[],clusterId:r,pageSize:a=50,fetchMore:s,fetchStatus:c}=e;return n.createElement(l.ZP,{data:t,columns:[{headerText:"Type",key:"recordingType",isSortable:!0,render:e=>{let{recordingType:t}=e;return p(t)}},{key:"hostname",headerText:"Name",isSortable:!0},{key:"users",headerText:"User(s)",render:e=>{let{users:t}=e;return n.createElement(l.bL,{style:{wordBreak:"break-word"}},t)},isSortable:!0},{key:"duration",headerText:"Duration",isSortable:!0,render:e=>{let{durationText:t}=e;return n.createElement(l.M4,{data:t})}},{key:"createdDate",headerText:"Created (UTC)",isSortable:!0,render:e=>{let{createdDate:t}=e;return n.createElement(l.bL,null,t)}},{key:"sid",headerText:"Session ID"},{altKey:"play-btn",render:e=>h(e,r)}],emptyText:"No Recordings Found",pagination:{pageSize:a},fetching:{onFetchMore:s,fetchStatus:c},initialSort:{key:"createdDate",dir:"DESC"},isSearchable:!0,searchableProps:["recordingType","hostname","description","createdDate","sid","users","durationText"],customSearchMatchers:[(0,u.vq)(["createdDate"])]})}const p=e=>{let t=d.zlj;return"desktop"===e?t=d.Hi7:"k8s"===e&&(t=d.YJo),n.createElement(l.bL,null,n.createElement(d.ZPm,{p:1,mr:3,fontSize:3,as:t}))},h=(e,t)=>{let{description:r,sid:a,recordingType:c,playable:o,duration:i}=e;if(!o)return n.createElement(l.bL,{align:"right",style:{color:"#9F9F9F"}},r);const u=g.Z.getPlayerRoute({clusterId:t,sid:a},{recordingType:c,durationMs:"desktop"===c?i:void 0});return n.createElement(l.bL,{align:"right"},n.createElement(s.ku,{kind:"primary",as:"a",href:u,width:"80px",target:"_blank",size:"small"},"Play"))};var y=r(4696),m=r(6828);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e){let{recordings:t,fetchStatus:r,fetchMore:i,range:l,setRange:u,rangeOptions:d,attempt:g,clusterId:p}=e;return n.createElement(o.Ob,null,n.createElement(o.OX,{alignItems:"center"},n.createElement(o.u4,{mr:"8"},"Session Recordings"),n.createElement(c.Z,{ml:"auto",range:l,ranges:d,onChangeRange:u})),"failed"===g.status&&n.createElement(a.b0,null," ",g.statusText," "),"processing"===g.status&&n.createElement(s.xu,{textAlign:"center",m:10},n.createElement(s.z$,null)),"success"===g.status&&n.createElement(f,{recordings:t,clusterId:p,fetchMore:i,fetchStatus:r}))}const k=function(){const e=function(e){const{clusterId:t}=(0,m.Z)(),r=(0,n.useMemo)((()=>(0,c.n)()),[]),[a,s]=(0,n.useState)(r[0]),{attempt:o,setAttempt:i,run:l}=(0,y.Z)("processing"),[u,d]=(0,n.useState)({recordings:[],fetchStartKey:"",fetchStatus:""});return(0,n.useEffect)((()=>{l((()=>e.recordingsService.fetchRecordings(t,S({},a)).then((e=>d({recordings:e.recordings,fetchStartKey:e.startKey,fetchStatus:e.startKey?"":"disabled"})))))}),[t,a]),S(S({},u),{},{attempt:o,range:a,rangeOptions:r,setRange:s,clusterId:t,fetchMore:function(){d(S(S({},u),{},{fetchStatus:"loading"})),e.recordingsService.fetchRecordings(t,S(S({},a),{},{startKey:u.fetchStartKey})).then((e=>d({recordings:[...u.recordings,...e.recordings],fetchStartKey:e.startKey,fetchStatus:e.startKey?"":"disabled"}))).catch((e=>{i({status:"failed",statusText:e.message})}))}})}((0,i.Z)());return n.createElement(O,e)}}}]);