"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[290],{5846:(e,t,r)=>{r.d(t,{M:()=>o,r:()=>n});var n={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},o={set:function(e,t,r){null!=e&&(e[t]=r)}}},6793:(e,t,r)=>{r.d(t,{FX:()=>d,jf:()=>h});var n=r(695),o=r(2711),s=r(5681),i=r(4859),a=new RegExp("^(?:[a-z][_0-9a-z-*/]{0,255}|[a-z0-9][_0-9a-z-*/]{0,240}@[a-z][_0-9a-z-*/]{0,13})$"),c=/^[ -~]{0,255}[!-~]$/,l=/,|=/,u=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,r){return t.push(r+"="+e.get(r)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var r=t.trim(),n=r.indexOf("=");if(-1!==n){var o=r.slice(0,n),s=r.slice(n+1,t.length);(function(e){return a.test(e)})(o)&&function(e){return c.test(e)&&!l.test(e)}(s)&&e.set(o,s)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}(),d="traceparent",p="tracestate",f=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$"),h=function(){function e(){}return e.prototype.inject=function(e,t,r){var a=n.g.getSpanContext(e);if(a&&!(0,i.Ll)(e)&&(0,o.BM)(a)){var c="00-"+a.traceId+"-"+a.spanId+"-0"+Number(a.traceFlags||s.r.NONE).toString(16);r.set(t,d,c),a.traceState&&r.set(t,p,a.traceState.serialize())}},e.prototype.extract=function(e,t,r){var o=r.get(t,d);if(!o)return e;var s=Array.isArray(o)?o[0]:o;if("string"!=typeof s)return e;var i=function(e){var t=f.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}(s);if(!i)return e;i.isRemote=!0;var a=r.get(t,p);if(a){var c=Array.isArray(a)?a.join(","):a;i.traceState=new u("string"==typeof c?c:void 0)}return n.g.setSpanContext(e,i)},e.prototype.fields=function(){return[d,p]},e}()},4859:(e,t,r)=>{r.d(t,{Ll:()=>s,hE:()=>o});var n=(0,r(3219).Y)("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function o(e){return e.setValue(n,!0)}function s(e){return!0===e.getValue(n)}},3937:(e,t,r)=>{r.d(t,{j2:()=>f,Oq:()=>l,sN:()=>n.sN,ZH:()=>n.ZH});var n=r(2760),o=r(2784),s=r(7849),i=r(3757);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends o.Component{constructor(e){super(e),c(this,"anchorEl",null),c(this,"state",{open:!1}),c(this,"onOpen",(e=>{e.stopPropagation(),this.setState({open:!0})})),c(this,"onClose",(()=>{this.setState({open:!1})})),this.state.open=e.defaultOpen||!1}render(){const{open:e}=this.state,{children:t,buttonIconProps:r,menuProps:c}=this.props;return o.createElement(o.Fragment,null,o.createElement(s.Ei,a({},r,{setRef:e=>this.anchorEl=e,onClick:this.onOpen,"data-testid":"button"}),o.createElement(i.mH4,null)),o.createElement(n.ZP,a({menuListCss:u,anchorEl:this.anchorEl,open:e,onClose:this.onClose,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},c),e&&this.renderItems(t)))}renderItems(e){return o.Children.toArray(e).map((e=>o.cloneElement(e,{onClick:this.makeOnClick(e.props.onClick)})))}makeOnClick(e){return t=>{t.stopPropagation(),this.onClose(),e&&e(t)}}}const u=()=>"\n  min-width: 100px;\n";function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f extends o.Component{constructor(e){super(e),p(this,"anchorEl",null),p(this,"state",{open:!1}),p(this,"onOpen",(e=>{e.stopPropagation(),this.setState({open:!0})})),p(this,"onClose",(()=>{this.setState({open:!1})})),this.state.open=e.defaultOpen||!1}render(){const{open:e}=this.state,{children:t,menuProps:r,buttonProps:a}=this.props;return o.createElement(o.Fragment,null,o.createElement(s.ku,d({height:"24px",size:"small",setRef:e=>this.anchorEl=e,onClick:this.onOpen},a),"OPTIONS",o.createElement(i.E_,{ml:2,mr:-2,fontSize:"2",color:"text.secondary"})),o.createElement(n.ZP,d({getContentAnchorEl:null,menuListCss:h,anchorEl:this.anchorEl,open:e,onClose:this.onClose,transformOrigin:{vertical:"top",horizontal:"right"},anchorOrigin:{vertical:"center",horizontal:"right"}},r),e&&this.renderItems(t)))}renderItems(e){return o.Children.toArray(e).map((e=>o.cloneElement(e,{onClick:this.makeOnClick(e.props.onClick)})))}makeOnClick(e){return t=>{t.stopPropagation(),this.onClose(),e&&e(t)}}}const h=()=>"\n  min-width: 100px;\n"},7038:(e,t,r)=>{r.d(t,{vf:()=>h,qV:()=>p,ZP:()=>m});var n=r(2784),o=r(4711),s=r(7308),i=r(917),a=r(2865);const c=["hasError"],l=["hasError"];function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u.apply(this,arguments)}function d(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function p(e){const{hasError:t=!1}=e,r=d(e,l);return n.createElement(f,{hasError:t},n.createElement(s.ZP,u({className:"react-select-container",classNamePrefix:"react-select",clearable:!1,isSearchable:!0,defaultOptions:!1,cacheOptions:!1,defaultMenuIsOpen:!1,placeholder:"Select..."},r)))}const f=i.ZP.div([".react-select-container{box-shadow:inset 0 2px 4px rgba(0,0,0,0.24);box-sizing:border-box;border:none;display:block;font-size:14px;outline:none;width:100%;color:rgba(0,0,0,0.87);background-color:#ffffff;margin-bottom:0px;border-radius:4px;}.react-select__control,.react-select__control--is-focused{min-height:40px;height:40px;background-color:transparent;border-color:transparent;border-radius:4px;border-style:solid;border-width:1px;box-shadow:none;"," &:hover{border-color:transparent;cursor:pointer;}}.react-select__option{&:hover{cursor:pointer;background-color:#eceff1;}}.react-select__option--is-focused{background-color:#eceff1;}.react-select__option--is-selected{background-color:#cfd8dc;color:inherit;&:hover{background-color:#cfd8dc;}}.react-select__menu{margin-top:0px;}.react-select__indicator-separator{display:none;}.react-select__loading-indicator{display:none;}.react-select--is-disabled{.react-select__single-value,.react-select__placeholder{color:rgba(0,0,0,0.24);}.react-select__indicator{color:rgba(0,0,0,0.14);}}"," ",""],(e=>{let{hasError:t,theme:r}=e;if(t)return{borderRadius:"inherit !important",borderWidth:"2px !important",border:`2px solid ${r.colors.error.main}  !important`}}),a.bf,a.Dh),h=(0,i.ZP)(f)((e=>{let{theme:t}=e;return`\n  .react-select-container {\n    background: transparent;\n  }\n\n  .react-select__option--is-focused:active {\n    background-color: ${t.colors.grey[50]};\n  }\n  \n  .react-select__value-container {\n    padding: 0 8px;\n  }\n\n  .react-select__single-value {\n    color: ${t.colors.text.primary}\n  }\n\n  \n  .react-select__control {\n    min-height: 34px;\n    height: 34px;\n    border-color: rgba(255, 255, 255, 0.24);\n    color: ${t.colors.text.secondary};\n\n    &:focus, &:active {\n      background-color: ${t.colors.primary.lighter};\n    }\n\n    &:hover {\n      border-color: rgba(255, 255, 255, 0.24);\n      background-color: ${t.colors.primary.lighter};\n      .react-select__dropdown-indicator {\n        color: #666;\n      }\n    }\n\n    .react-select__indicator,\n    .react-select__dropdown-indicator {\n      padding: 4px 8px;\n      color: #666;\n      &:hover {\n        color: #999;\n      }\n    }\n  }\n\n  .react-select__control--menu-is-open {\n    background-color: ${t.colors.primary.lighter};\n    border-color: transparent;\n    border-radius: 4px;\n    border-style: solid;\n    border-width: 1px;\n    box-shadow: none;\n    border-color: rgba(255, 255, 255, 0.24);\n\n    .react-select__indicator,\n    .react-select__dropdown-indicator {\n      color: #999 !important;\n      &:hover {\n        color: #ccc !important;\n      }\n    }\n  }\n\n  .react-select__input {\n    color: ${t.colors.text.primary}\n  }\n\n  .react-select__placeholder {\n    color: ${t.colors.text.secondary}\n  }\n\n  .react-select__option {\n    padding: 4px 12px;\n  } \n\n  .react-select__menu {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n  }\n\n  .react-select__multi-value {\n    background-color: ${t.colors.primary.dark};\n    border: 1px solid ${t.colors.text.placeholder};\n  }\n\n  .react-select__multi-value__label {\n    color: ${t.colors.text.primary};\n    padding: 0 6px;\n  }\n\n  .react-select--is-disabled {\n    .react-select__single-value,\n    .react-select__placeholder,\n    .react-select__indicator {\n      color: ${t.colors.text.placeholder};\n    }\n  }\n`})),m=function(e){const{hasError:t=!1}=e,r=d(e,c);return n.createElement(f,{hasError:t},n.createElement(o.ZP,u({menuPlacement:"auto",className:"react-select-container",classNamePrefix:"react-select",clearable:!1,isMulti:!1,isSearchable:!0,placeholder:"Select..."},r)))}},1527:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(917),o=r(7849),s=(r(3886),r(7559));const i=(0,n.ZP)(o.xu)((()=>`\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n\n  .terminal .xterm-viewport {\n    background-color: ${s.O.bgTerminal} !important;\n  }\n`))},7559:(e,t,r)=>{r.d(t,{O:()=>n});const n={dark:"#000",light:"#fff",subtle:"#CFD8DC",inverse:"#B0BEC5",link:"#039BE5",error:"#FF1744",terminal:"#28FE14",terminalDark:"#01172C",bgTerminal:"#010B1C",primary:{light:"#03203C",lighter:"#092F52",dark:"#01172C",main:"#010B1C"},text:"#263238",success:"#00BFA5",progressBarColor:"#00BFA5"}},7830:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Wt});var n=r(2784),o=r(917),s=r(7849),i=r(5849);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c extends n.Component{constructor(e){super(e),a(this,"_timerId",null),a(this,"_request",null),this._intervalTime=e.time||3e3}fetch(){this._request||(this._request=this.props.onFetch().finally((()=>{this._request=null})))}componentDidMount(){this.props.immediately&&this.fetch(),this._timerId=setInterval(this.fetch.bind(this),this._intervalTime)}componentWillUnmount(){clearInterval(this._timerId),this._request&&this._request.abort&&this._request.abort()}render(){return null}}a(c,"defaultProps",{immediately:!0});const l=c;var u=r(2566);const d=n.createContext(null),p=e=>n.createElement(d.Provider,e);function f(){const e=n.useContext(d);return window.teleconsole=e,e}var h=r(7559),m=r(2865),g=r(3757),b=r(4073),y=r.n(b),v=r(8394),w=r(135);const O=o.ZP.div(["display:flex;width:16px;height:16px;font-size:11px;font-weight:bold;overflow:hidden;align-items:center;flex-shrink:0;border-radius:50%;justify-content:center;margin-right:3px;background-color:",";"],(e=>e.active?w.Z.colors.accent:w.Z.colors.grey[900])),E=o.ZP.div(["background:",";color:",";border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:12px;font-weight:bold;height:24px;margin-right:16px;width:24px;"],(e=>e.theme.colors.accent),(e=>e.theme.colors.light)),x=o.ZP.div(["border-bottom:1px solid ",";color:",";font-size:12px;align-items:center;display:flex;padding:8px;&:last-child{border:none;}"],w.Z.colors.grey[50],w.Z.colors.grey[600]),C=function(e){const{active:t,users:r,open:o=!1,ml:i,mr:a}=e,c=n.useRef(null),[l,u]=n.useState(o),d=n.useMemo((()=>y()((()=>u(!0)),300)),[]);function p(){d.cancel(),u(!1)}if(r.length<2)return null;const f=r.map(((e,t)=>{const r=(e.user||"").trim().charAt(0).toUpperCase();return n.createElement(x,{key:`${t}${e.user}`},n.createElement(E,null,r),e.user)}));return n.createElement(O,{active:t,ml:i,mr:a,ref:c,onMouseLeave:p,onMouseEnter:function(){d.cancel(),d()}},r.length,n.createElement(v.Z,{open:l,anchorEl:c.current,onClose:p,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},n.createElement(s.xu,{minWidth:"200px",bg:"white",borderRadius:"8px",onMouseLeave:p},f)))};function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){const{name:t,users:r,active:o,onClick:i,onClose:a,style:c}=e;return n.createElement(D,{alignItems:"center",active:o,style:c},n.createElement(j,{onClick:i},n.createElement(C,{mr:"1",users:r,active:o}),n.createElement(s.xv,{mx:"auto",title:t},t)),n.createElement(T,{title:"Close",onClick:a},n.createElement(g.x8P,null)))}const D=(0,o.ZP)(s.kC)(["max-width:200px;height:100%;",""],(function(e){let{theme:t,active:r}=e,n={border:"none",borderRight:`1px solid ${t.colors.bgTerminal}`,"&:hover, &:focus":{color:t.colors.primary.contrastText,transition:"color .3s"}};return r&&(n=P(P({},n),{},{backgroundColor:t.colors.bgTerminal,color:t.colors.primary.contrastText,fontWeight:"bold",transition:"none"})),n})),j=o.ZP.button(["display:flex;flex:1;align-items:center;cursor:pointer;text-decoration:none;outline:none;margin:0;text-decoration:none;color:inherit;line-height:32px;background-color:transparent;white-space:nowrap;overflow:hidden;padding:0 16px;text-overflow:ellipsis;border:none;"]),T=o.ZP.button(["background:transparent;border-radius:2px;border:none;cursor:pointer;height:16px;width:16px;outline:none;padding:0;margin:0 8px 0 0;transition:all 0.3s;&:hover{background:",";}",""],(e=>e.theme.colors.danger),m.Dh),I=["items","parties","activeTab","onSelect","onClose","onNew","disableNew"];function A(){return A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A.apply(this,arguments)}function N(e){const{items:t,parties:r,activeTab:o,onSelect:i,onClose:a,onNew:c,disableNew:l}=e,u=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,I),d=t.filter((e=>"blank"!==e.kind)).map((e=>{const t=e.id===o;let s=[];return"terminal"===e.kind&&(s=r[e.sid]||[]),n.createElement(k,{name:e.title,key:e.id,users:s,active:t,onClick:()=>i(e),onClose:()=>a(e),style:{flex:"1",flexBasis:"0",flexGrow:"1"}})}));return n.createElement(Z,A({as:"nav",typography:"h5",color:"text.secondary",bold:!0},u),d,d.length>0&&n.createElement(s.Ei,{ml:"2",size:0,disabled:l,title:"New Tab",onClick:c},n.createElement(g.mm_,{fontSize:"16px"})))}const Z=(0,o.ZP)(s.xu)(["background:",";min-height:32px;border-radius:4px;display:flex;flex-wrap:no-wrap;align-items:center;flex-shrink:0;overflow:hidden;",""],h.O.terminalDark,m.cp),z=function(e){const t=f();return(0,u.o)(t.storeParties),n.createElement(N,A({},e,{parties:t.storeParties.state}))};var R=r(7933),L=r(3937),B=r(7278);const U={menuListCss:()=>"\n  width: 250px;\n"},F=function(e){return n.createElement(s.kC,{alignItems:"center"},n.createElement(L.Oq,{buttonIconProps:{mr:2,ml:2,size:0,style:{fontSize:"16px"}},menuProps:U},n.createElement(L.sN,{as:R.OL,to:B.Z.routes.root},n.createElement(L.ZH,{as:g.SK8,mr:"2"}),"Main"),n.createElement(L.sN,null,n.createElement(s.DF,{my:3,block:!0,onClick:e.onLogout},"Sign Out"))))};var M;!function(e){e.Download="Download",e.Upload="Upload"}(M||(M={}));var $=r(8227),H=r(2030),q=r(7097),K=r(8197);function W(){return W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W.apply(this,arguments)}const V=o.ZP.form.attrs((()=>({"aria-label":"form"})))([""]),J=(0,n.forwardRef)(((e,t)=>{function r(e){const t=e.target.value;e.target.value="",e.target.value=t}return n.createElement(K.ZP,null,(o=>{let{validator:s}=o;return n.createElement(G,W({},e,{onFocus:r,ref:t,spellCheck:!1,mb:0,mt:0,width:"100%",onBlur:()=>s.validate(),rule:(0,q.lp)("Path is required")}))}))})),G=(0,o.ZP)(H.Z)(["input{border:1px solid rgba(255,255,255,0.1);background:transparent;color:white;box-shadow:none;font-size:14px;height:32px;}"]);function X(e){const[t,r]=(0,n.useState)("~/"),o=!t.endsWith("/");return n.createElement(V,{onSubmit:r=>{r.preventDefault(),e.onAddDownload(t)}},n.createElement(s.kC,{alignItems:"end"},n.createElement(J,{label:"File Path",autoFocus:!0,onChange:e=>r(e.target.value),value:t}),n.createElement($.DF,{ml:2,px:3,size:"medium",title:"Download",disabled:!o,type:"submit"},"Download")))}function Y(e){const t=(0,n.useRef)(),r=(0,n.useRef)(),[o,i]=(0,n.useState)("~/");function a(t){t.forEach((t=>{e.onAddUpload(o,t)}))}function c(){r.current.value="",r.current.click()}function l(e){e.currentTarget.style.removeProperty("background-color")}const u=!o;return n.createElement(V,null,n.createElement(J,{label:"Upload destination",value:o,autoFocus:!0,onChange:e=>i(e.target.value),onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),c())}}),n.createElement(ee,{ref:r,disabled:u,type:"file","data-testid":"file-input",multiple:!0,accept:"*.*",onChange:function(e){a(Array.from(e.target.files))}}),n.createElement(Q,{disabled:u,ref:t,onDragOver:e=>{e.preventDefault(),function(e){e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)"}(e)},onDragLeave:l,onDrop:function(e){l(e);const{files:t}=e.dataTransfer;e.preventDefault(),e.stopPropagation(),a(Array.from(t))},onClick:e=>{e.preventDefault(),c()}},n.createElement(g.xX_,{fontSize:10,mb:2}),n.createElement(s.xv,{typography:"h6"},"Drag your files here"),n.createElement(s.xv,{typography:"body2"},"or Browse your computer to start uploading")))}const Q=o.ZP.button(["display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;color:inherit;background-color:rgba(255,255,255,0.05);margin-top:","px;border:1px dashed rgba(255,255,255,0.1);height:128px;text-align:center;cursor:pointer;opacity:",";pointer-events:",";border-radius:","px;font-family:inherit;:focus{border-color:",";}"],(e=>e.theme.space[3]),(e=>e.disabled?.7:1),(e=>e.disabled?"none":"unset"),(e=>e.theme.radii[2]),(e=>e.theme.colors.action.selected));var ee=(0,o.ZP)("input")(["display:none;"]);function te(e){const{name:t,transferState:r,id:o}=e.file;return(0,n.useEffect)((()=>()=>e.onCancel(o)),[e.onCancel]),n.createElement(oe,null,n.createElement(s.kC,{justifyContent:"space-between",alignItems:"center"},n.createElement(s.kC,{alignItems:"center"},n.createElement(ae,{typography:"body2"},t),"completed"===r.type&&n.createElement(g.yGk,{ml:2,fontSize:"14px",color:"progressBarColor",title:"Transfer completed"})),"processing"===r.type&&n.createElement(s.Ei,{title:"Cancel",size:0,mt:"-4px",mb:"-4px",onClick:()=>e.onCancel(o)},n.createElement(g.X1q,null))),("processing"===r.type||"error"===r.type)&&n.createElement(s.kC,{alignItems:"baseline",mt:1},n.createElement(ne,{mr:1},r.progress,"%"),n.createElement(se,null,n.createElement(ie,{progress:r.progress,isFailure:"error"===r.type}))),"error"===r.type&&n.createElement(re,null,r.error.message))}const re=e=>n.createElement(s.xv,{color:"error.light",typography:"body2",mt:1},n.createElement(g.v3j,{mr:1,color:"inherit"}),e.children),ne=(0,o.ZP)(s.xv)(["line-height:16px;width:36px;"]),oe=o.ZP.li(["list-style:none;margin-top:","px;font-size:","px;"],(e=>e.theme.space[3]),(e=>e.theme.fontSizes[1])),se=o.ZP.div(["border-radius:50px;background:rgba(255,255,255,0.05);width:100%;"]),ie=o.ZP.div(["border-radius:50px;background:",";height:8px;width:","%;"],(e=>e.isFailure?e.theme.colors.disabled:e.theme.colors.progressBarColor),(e=>e.progress));var ae=(0,o.ZP)(s.xv)(["word-break:break-all;"]);function ce(e){return e.files.length?n.createElement(le,null,e.files.map((t=>n.createElement(te,{key:t.id,file:t,onCancel:e.onCancel})))):null}const le=o.ZP.ul(["padding-left:0;overflow:auto;max-height:300px;margin-top:0;margin-bottom:0;padding-right:16px;margin-right:-16px;"]);function ue(e){const t=e.openedDialog===M.Download?{header:"Download Files",Form:n.createElement(X,{onAddDownload:e.onAddDownload})}:{header:"Upload Files",Form:n.createElement(Y,{onAddUpload:e.onAddUpload})};return n.createElement(pe,{"data-testid":"file-transfer-container",backgroundColor:e.backgroundColor,onKeyDown:t=>{"Escape"===t.key&&(t.preventDefault(),t.stopPropagation(),e.onClose())}},n.createElement(s.kC,{justifyContent:"space-between",alignItems:"baseline"},n.createElement(s.xv,{fontSize:3,bold:!0,mb:3},t.header),n.createElement(de,{onClick:e.onClose})),t.Form,n.createElement(ce,{files:e.files,onCancel:e.onCancel}))}function de(e){return n.createElement(s.Ei,{title:"Close",onClick:e.onClick},n.createElement(g.x8P,null))}const pe=o.ZP.div(["background:",";box-shadow:0 8px 32px rgba(0,0,0,0.1);box-sizing:border-box;border-radius:","px;padding:8px 16px 16px;position:absolute;right:8px;top:8px;width:500px;z-index:10;"],(e=>e.backgroundColor||e.theme.colors.primary.light),(e=>e.theme.radii[2])),fe=n.createContext(null),he=e=>{const[t,r]=(0,n.useState)(e.openedDialog);return n.createElement(fe.Provider,{value:{openedDialog:t,openDownloadDialog:function(){r(M.Download)},openUploadDialog:function(){r(M.Upload)},closeDialog:function(){r(void 0)}},children:e.children})},me=()=>{const e=(0,n.useContext)(fe);if(!e)throw new Error("FileTransfer requires FileTransferContextProvider context.");return e};function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){ye(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ve={ids:[],filesById:{}};function we(e,t){switch(t.type){case"add":return{ids:[t.payload.id,...e.ids],filesById:be(be({},e.filesById),{},{[t.payload.id]:be(be({},t.payload),{},{transferState:{type:"processing",progress:0}})})};case"updateTransferState":{const r=()=>{if("error"===t.payload.transferState.type){const{transferState:r}=e.filesById[t.payload.id];return be(be({},t.payload.transferState),{},{progress:"processing"===r.type?r.progress:0})}return t.payload.transferState};return be(be({},e),{},{filesById:be(be({},e.filesById),{},{[t.payload.id]:be(be({},e.filesById[t.payload.id]),{},{transferState:r()})})})}default:throw new Error("Unhandled action",t)}}function Oe(e){const{openedDialog:t,closeDialog:r}=me();return t?n.createElement(Ee,{openedDialog:t,backgroundColor:e.backgroundColor,transferHandlers:e.transferHandlers,onCloseDialog:async function(t){const n=()=>{var t;r(),null===(t=e.afterClose)||void 0===t||t.call(e)};t&&e.beforeClose?await e.beforeClose()&&n():n()}}):null}function Ee(e){const t=(()=>{const[e,t]=(0,n.useReducer)(we,ve),r=(0,n.useRef)(new Map),o=(0,n.useCallback)(((e,r)=>{t({type:"updateTransferState",payload:{id:e,transferState:r}})}),[]),s=(0,n.useCallback)((e=>{var t;null===(t=r.current)||void 0===t||t.get(e).abort()}),[]),i=(0,n.useMemo)((()=>e.ids.map((t=>e.filesById[t]))),[e.ids,e.filesById]),a=(0,n.useCallback)((()=>i.some((e=>"processing"===e.transferState.type))),[i]);return{files:i,start:async e=>{const n=new AbortController,s=await e.runFileTransfer(n);if(!s)return;const i=(new Date).getTime()+e.name;t({type:"add",payload:{id:i,name:e.name}}),r.current.set(i,n),s.onProgress((e=>{o(i,{type:"processing",progress:e})})),s.onError((e=>{o(i,{type:"error",progress:void 0,error:e})})),s.onComplete((()=>{o(i,{type:"completed"})}))},cancel:s,isAnyTransferInProgress:a}})();return n.createElement(ue,{openedDialog:e.openedDialog,files:t.files,onCancel:t.cancel,backgroundColor:e.backgroundColor,onClose:function(){e.onCloseDialog(t.isAnyTransferInProgress())},onAddUpload:function(r,n){t.start({name:n.name,runFileTransfer:t=>e.transferHandlers.getUploader(r,n,t)})},onAddDownload:function(r){t.start({name:r,runFileTransfer:t=>e.transferHandlers.getDownloader(r,t)})}})}function xe(e){let{isConnected:t}=e;const r=me(),o=r.openedDialog||!t;return n.createElement(s.kC,{flex:"none",alignItems:"center",height:"24px"},n.createElement(s.Ei,{disabled:o,size:0,title:"Download files",onClick:r.openDownloadDialog},n.createElement(g.UWx,{fontSize:"16px"})),n.createElement(s.Ei,{disabled:o,size:0,title:"Upload files",onClick:r.openUploadDialog},n.createElement(g.gqx,{fontSize:"16px"})))}var Ce=r(2699);function Se(){const e=new Ce.EventEmitter;return{emitProgress:t=>{e.emit("progress",t)},emitComplete:()=>{e.emit("complete")},emitError:t=>{e.emit("error",t)},onProgress:t=>{e.on("progress",t)},onComplete:t=>{e.on("complete",t)},onError:t=>{e.on("error",t)}}}var Pe=r(4523),_e=r(2070);const ke=["visible","children"];function De(){return De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},De.apply(this,arguments)}const je=e=>{let{visible:t,children:r}=e,o=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,ke);return n.createElement(s.kC,De({flex:"1",style:{overflow:"auto",background:h.O.bgTerminal,display:t?"flex":"none",position:"relative"}},o),r)};var Te=r(3958),Ie=r(6209);function Ae(e){const t=["1","2","3","4","5","6","7","8","9"].indexOf(e.key),{isMac:r}=(0,Te.Z)();let n;return(r&&e.ctrlKey||e.altKey)&&-1!==t&&(n={index:t}),{tabSwitch:n}}var Ne=r(1527);function Ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ze extends n.Component{constructor(){super(...arguments),Ze(this,"terminal",void 0),Ze(this,"refTermContainer",n.createRef())}componentDidMount(){const e=(0,Te.Z)().isMac?12:14;this.terminal=new Ie.Z(this.props.tty,{el:this.refTermContainer.current,fontFamily:this.context.fonts.mono,fontSize:e}),this.terminal.open(),this.terminal.term.attachCustomKeyEventHandler((e=>{const{tabSwitch:t}=Ae(e);if(t)return!1}))}componentWillUnmount(){this.terminal.destroy()}shouldComponentUpdate(){return!1}focus(){this.terminal.term.focus()}render(){return n.createElement(s.kC,{flexDirection:"column",height:"100%",width:"100%",px:"2",style:{overflow:"auto"}},n.createElement(Ne.Z,{ref:this.refTermContainer}))}}Ze(ze,"contextType",o.Ni);const Re=ze;var Le=r(695),Be=r(9689),Ue=r(3094);const Fe=Le.g.getTracer("TTY");var Me=r(1452);function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){qe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ke(){return{upload(e,t,r){const n=Se(),o=We({method:"post",url:e,eventEmitter:n,abortController:r,transformFailedResponse:()=>Ve(o.response)});return o.upload.addEventListener("progress",(e=>{n.emitProgress(Je(e))})),o.send(t),n},download(e,t){const r=Se(),n=We({method:"get",url:e,eventEmitter:r,abortController:t,transformSuccessfulResponse:()=>{const e=function(e){let t="";const r=e.getResponseHeader("Content-Disposition");if(r){const e=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(r);null!=e&&e[1]&&(t=e[1].replace(/['"]/g,""))}return decodeURIComponent(t)}(n);if(!e)throw new Error("Bad response");!function(e,t){const r=document.createElement("a");r.href=window.URL.createObjectURL(t),r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}(e,n.response)},transformFailedResponse:()=>{return e=n.response,new Promise((t=>{const r=new FileReader;r.onerror=()=>{t(r.error.message)},r.onload=()=>{const e=Ve(r.result);t(e)},r.readAsText(e)}));var e}});return n.onprogress=e=>{200===n.status&&r.emitProgress(Je(e))},n.responseType="blob",n.send(),r}}}function We(e){let{method:t,url:r,abortController:n,eventEmitter:o,transformSuccessfulResponse:s,transformFailedResponse:i}=e;const a=new XMLHttpRequest;return a.open(t,r,!0),function(){const e=He(He({},(0,Me.g0)()),(0,Me.EC)());Object.keys(e).forEach((t=>{a.setRequestHeader(t,e[t])}))}(),n&&(n.signal.onabort=()=>{a.abort()}),a.onload=async()=>{if(200===a.status)try{null==s||s(),o.emitComplete()}catch(e){o.emitError(e)}else o.emitError(new Error(await i()))},a.onerror=async()=>{o.emitError(new Error(await i()))},a.ontimeout=()=>{o.emitError(new Error("Request timed out."))},a.onabort=()=>{o.emitError(new DOMException("Aborted","AbortError"))},a}function Ve(e){const t="Bad request";if(!e)return t;try{var r;const n=JSON.parse(e);return(null===(r=n.error)||void 0===r?void 0:r.message)||n.message||t}catch(e){return"Bad request, failed to parse error message."}}function Je(e){if(e.lengthComputable)return Math.round(e.loaded/e.total*100);{const t=e.loaded,r=e.total;return Math.floor(t/r*1e3)/10}}const Ge=function(e){let{doc:t,visible:r}=e;const o=(0,n.useRef)(),{tty:i,status:a,closeDocument:c}=function(e){const{clusterId:t,sid:r,serverId:o,login:s}=e,i=f(),a=n.useRef(null),c=a.current,[l,u]=n.useState(null),[d,p]=n.useState("loading");return n.useEffect((()=>(function(t){Fe.startActiveSpan("initTTY",void 0,Be.D.active(),(r=>{const n=i.createTty(t);n.on(Ue.dw.CLOSE,(()=>i.closeTab(e))),n.on(Ue.dw.CONN_CLOSE,(()=>i.updateSshDocument(e.id,{status:"disconnected"}))),n.on(Ue.dw.SESSION,(t=>{const r=JSON.parse(t);r.session.kind="ssh",r.session.resourceName=r.session.server_hostname,function(e,t,r){const{resourceName:n,login:o,id:s,cluster_name:i,server_id:a,created:c}=t,l=B.Z.getSshSessionRoute({sid:s,clusterId:i}),u=new Date(c);e.updateSshDocument(r,{title:`${o}@${n}`,status:"connected",url:l,serverId:a,created:u,login:o,sid:s,clusterId:i}),e.gotoTab({url:l})}(i,r.session,e.id)})),a.current=n,u(t),p("initialized"),r.end()}))}({login:s,serverId:o,clusterId:t,sid:r}),function(){a.current&&a.current.removeAllListeners()})),[]),{tty:c,status:d,session:l,closeDocument:function(){i.closeTab(e)}}}(t),l=(0,_e.Z)(i);return(0,n.useEffect)((()=>{o&&o.current&&o.current.terminal.term.focus()}),[r,l.requested]),n.createElement(je,{visible:r,flexDirection:"column"},n.createElement(he,null,n.createElement(xe,{isConnected:"connected"===t.status}),"loading"===a&&n.createElement(s.xu,{textAlign:"center",m:10},n.createElement(s.z$,null)),l.requested&&n.createElement(Pe.Z,{onContinue:l.authenticate,onCancel:c,errorText:l.errorText}),"initialized"===a&&n.createElement(Re,{tty:i,ref:o}),n.createElement(Oe,{beforeClose:()=>window.confirm("Are you sure you want to cancel file transfers?"),afterClose:function(){o.current.terminal.term.focus()},backgroundColor:h.O.primary.light,transferHandlers:{getDownloader:async(e,r)=>Ke().download(B.Z.getScpUrl({location:e,clusterId:t.clusterId,serverId:t.serverId,login:t.login,filename:e}),r),getUploader:async(e,r,n)=>Ke().upload(B.Z.getScpUrl({location:e,clusterId:t.clusterId,serverId:t.serverId,login:t.login,filename:r.name}),r,n)}})))};var Xe=r(6189),Ye=r(6900),Qe=r(2499),et=r(7038);const tt=["value","onChange","defaultMenuIsOpen"];const rt=(0,o.ZP)(et.vf)((e=>{let{theme:t}=e;return`\n  .react-select-container {\n    background: ${t.colors.primary.light};\n  }\n\n  .react-select__single-value {\n    color: white;\n    padding: 0 4px;\n    margin: 0;\n  }\n`})),nt=function(e){let{value:t,onChange:r,defaultMenuIsOpen:o=!1}=e,i=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,tt);const a=f(),[c,l]=n.useState(null),[u,d]=n.useState([]),p={value:t,label:t};return n.createElement(s.xu,i,n.createElement(s.SO,null," Clusters "),n.createElement(rt,null,n.createElement(et.qV,{noOptionsMessage:function(){return c?`Error: ${c}`:"No leaf clusters found"},value:p,onChange:function(e){r(e.value)},loadOptions:function(e){let t=Promise.resolve(u);return 0===u.length&&(t=a.fetchClusters().then((e=>e.map((e=>({value:e.clusterId,label:e.clusterId}))))).then((e=>(d(e),e)))),t.then((t=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e=e.toLocaleLowerCase(),t.filter((t=>-1!==t.value.toLocaleLowerCase().indexOf(e)))}(e,t))).catch((e=>{l(e.message)}))},defaultMenuIsOpen:o,hasError:!1,maxMenuHeight:400,isSearchable:!0,isSimpleValue:!1,isClearable:!1,defaultOptions:!0,cacheOptions:!0})))};var ot=r(4517),st=r(4696),it=r(1392),at=r(321),ct=r(9068),lt=r(8604);function ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(r),!0).forEach((function(t){pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ft=r(6393);function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){gt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const bt=mt(mt({},w.Z),{},{colors:mt(mt({},w.Z.colors),{},{primary:mt(mt({},w.Z.colors.primary),h.O.primary)})}),yt=e=>n.createElement(ft.Z,{theme:bt,children:e.children}),vt=(0,o.ZP)(s.xu)(["flex-direction:column;display:flex;flex:1;max-width:1024px;::after{content:' ';padding-bottom:24px;}"]),wt=function(e){const{doc:t,visible:r}=e,{results:o,fetchNext:i,fetchPrev:a,pageSize:c,from:l,to:u,params:d,setParams:p,startKeys:h,setSort:m,pathname:g,replaceHistory:b,fetchStatus:y,attempt:v,createSshSession:w,changeCluster:O,getNodeSshLogins:E,onLabelClick:x}=function(e){let{clusterId:t,id:r}=e;const o=f(),{search:s,pathname:i}=(0,ot.TH)(),[a,c]=(0,n.useState)([]),{attempt:l,setAttempt:u}=(0,st.Z)("processing"),[d,p]=(0,n.useState)(""),[h,m]=(0,n.useState)(dt({sort:{fieldName:"hostname",dir:"ASC"}},(0,at.Z)(s))),[g,b]=(0,n.useState)({nodes:[],startKey:"",totalCount:0}),y=g.totalCount>0?15*(a.length-2)+1:0,v=g.totalCount>0?y+g.nodes.length-1:0;function w(e){it.Z.replace(e)}return(0,n.useEffect)((()=>{u({status:"processing"}),o.fetchNodes(t,dt(dt({},h),{},{limit:15})).then((e=>{let{nodesRes:t}=e;b({nodes:t.agents,startKey:t.startKey,totalCount:t.totalCount}),p(t.startKey?"":"disabled"),c(["",t.startKey]),u({status:"success"})})).catch((e=>{u({status:"failed",statusText:e.message}),b(dt(dt({},g),{},{nodes:[],totalCount:0})),c([""])}))}),[t,s]),{attempt:l,createSshSession:function(e,n){const s=o.getSshDocumentUrl({serverId:n,login:e,clusterId:t});o.gotoTab({url:s}),o.removeDocument(r)},changeCluster:function(e){const t=e,n=o.getNodeDocumentUrl(t);o.storeDocs.update(r,{url:n,clusterId:t}),o.gotoTab({url:n})},getNodeSshLogins:function(e){const r=g.nodes.find((t=>t.id==e));return function(e,t){const r=(null==t?void 0:t.sshLogins)||[];return(0,lt.X)(r).map((r=>({login:r,url:o.getSshDocumentUrl({clusterId:e,serverId:(null==t?void 0:t.id)||"",login:r})})))}(t,r)},results:g,fetchNext:()=>{p("loading"),o.fetchNodes(t,dt(dt({},h),{},{limit:15,startKey:g.startKey})).then((e=>{let{nodesRes:t}=e;b(dt(dt({},g),{},{nodes:t.agents,startKey:t.startKey})),p(t.startKey?"":"disabled"),c([...a,t.startKey])})).catch((e=>{u({status:"failed",statusText:e.message})}))},fetchPrev:()=>{p("loading"),o.fetchNodes(t,dt(dt({},h),{},{limit:15,startKey:a[a.length-3]})).then((e=>{let{nodesRes:t}=e;b(dt(dt({},g),{},{nodes:t.agents,startKey:t.startKey}));const r=a;r.pop(),c(r),p(t.startKey?"":"disabled")})).catch((e=>{u({status:"failed",statusText:e.message})}))},pageSize:15,from:y,to:v,params:h,setParams:m,startKeys:a,setSort:function(e){m(dt(dt({},h),{},{sort:e}))},pathname:i,replaceHistory:w,fetchStatus:d,onLabelClick:e=>(0,ct.Z)(e,h,m,i,w)}}(t);return n.createElement(yt,null,n.createElement(je,{visible:r},n.createElement(vt,{mx:"auto",mt:"4",px:"5"},n.createElement(s.kC,{justifyContent:"space-between",mb:"4",alignItems:"end"},n.createElement(nt,{value:t.clusterId,width:"336px",maxMenuHeight:200,mr:"20px",onChange:function(e){O(e)}}),n.createElement(Ye.Z,{width:"240px",onPress:function(e,t){w(e,t)}})),"processing"===v.status&&n.createElement(s.xu,{textAlign:"center",m:10},n.createElement(s.z$,null)),"failed"===v.status&&n.createElement(Qe.Z,{message:v.statusText}),"processing"!==v.status&&n.createElement(Xe.Z,{nodes:o.nodes,totalCount:o.totalCount,onLoginMenuOpen:function(e){return E(e)},onLoginSelect:function(e,t,r){e.ctrlKey||e.metaKey||(e.preventDefault(),w(t,r))},fetchNext:i,fetchPrev:a,fetchStatus:y,from:l,to:u,pageSize:c,params:d,setParams:p,startKeys:h,setSort:m,pathname:g,replaceHistory:b,onLabelClick:x}))))},Ot=function(e){const{visible:t,doc:r}=e,o=f();return n.createElement(je,{visible:t},n.createElement(s.kC,{flexDirection:"column",alignItems:"center",flex:"1"},n.createElement(g.zlj,{fontSize:"256px",mt:"10",mb:"6",color:h.O.terminalDark}),n.createElement(s.DF,{onClick:function(){o.gotoNodeTab(r.clusterId)},children:"Start a New Session"})))};function Et(){const e=f(),t=(0,i.Z)(),{verifyAndConfirm:r}=function(e,t){function r(e){if("terminal"!==e.kind||"connected"!==e.status)return!1;const t=e.created.getTime();return(new Date).getTime()-t>3e4}return n.useEffect((()=>{const n=n=>{t.isValid()&&e.getDocuments().some(r)&&(n.preventDefault(),n.returnValue="")};return window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n)}}),[]),{verifyAndConfirm:function(t){if(r(t)){const r=t.sid,n=e.storeParties.state[r];return!n||(n.length>1?window.confirm("Are you sure you want to leave this session?"):window.confirm("Are you sure you want to terminate this session?"))}return!0},hasLastingSshConnection:r}}(e,t),{clusterId:o,activeDocId:a}=function(e){const{pathname:t}=(0,ot.TH)(),{clusterId:r}=(0,ot.UO)(),o=(0,ot.$B)(B.Z.routes.consoleConnect),s=(0,ot.$B)(B.Z.routes.consoleNodes),i=(0,ot.$B)(B.Z.routes.consoleSession);return n.useMemo((()=>{-1===e.getActiveDocId(t)&&(o?e.addSshDocument(o.params):i?e.addSshDocument(i.params):s&&e.addNodeDocument(r))}),[e,t]),{clusterId:r,activeDocId:e.getActiveDocId(t)}}(e),c=e.storeDocs,d=c.getDocuments(),p=d.find((e=>e.id===a)),m=c.getSshDocuments().length>0;var g;(e=>{n.useEffect((()=>{const t=t=>{const{tabSwitch:r}=Ae(t);if(!r)return;t.preventDefault();const n=e.getDocuments()[r.index+1];n&&e.gotoTab(n)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)}),[])})(e),g=e,(0,u.o)(g.storeDocs),function(e){const t=e&&e.title?`${e.clusterId} • ${e.title}`:"Console";n.useEffect((()=>{document.title=t}),[t])}(p);const b=c.getNodeDocuments().length>0,y=d.map((e=>n.createElement(xt,{doc:e,visible:e.id===a,key:e.id})));return n.createElement(Ct,null,n.createElement(s.kC,{bg:h.O.terminalDark,height:"32px"},n.createElement(z,{flex:"1",items:d,onClose:function(t){r(t)&&e.closeTab(t)},onSelect:function(t){e.gotoTab(t)},activeTab:a,clusterId:o,disableNew:b,onNew:function(){e.gotoNodeTab(o)}}),n.createElement(F,{onLogout:function(){t.logout()}})),y,m&&n.createElement(l,{time:5e3,onFetch:function(){return e.refreshParties()}}))}function xt(e){const{doc:t,visible:r}=e;return n.useMemo((()=>{switch(t.kind){case"terminal":return n.createElement(Ge,{doc:t,visible:r});case"nodes":return n.createElement(wt,{doc:t,visible:r});default:return n.createElement(Ot,{doc:t,visible:r})}}),[r,t])}const Ct=o.ZP.div(["background-color:",";bottom:0;left:0;position:absolute;right:0;top:0;display:flex;flex-direction:column;"],h.O.bgTerminal);var St=r(2418),Pt=r(5846),_t=r(6793),kt=r(8005);function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(r),!0).forEach((function(t){Tt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Tt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class It{constructor(e){Tt(this,"_cfg",{ttyUrl:null,ttyParams:{}}),this._cfg=jt({},e)}getConnStr(e,t){const{ttyParams:r,ttyUrl:n}=this._cfg,o=JSON.stringify(jt(jt({},r),{},{term:{h:t,w:e}})),s=window.encodeURI(o);return n.replace(":params",s)}}var At=r(3687),Nt=r(1226),Zt=r(5306);function zt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(r),!0).forEach((function(t){Lt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Bt extends u.y{constructor(){super(...arguments),Lt(this,"state",{items:[]})}add(e){const t=Rt({id:Math.floor(1e5*Math.random())},e);return this.setState({items:[...this.state.items,t]}),t}update(e,t){const r=this.state.items.map((r=>r.id===e?Rt(Rt({},r),t):r));this.setState({items:r})}filter(e){return this.state.items.filter((t=>t.id!==e))}getNext(e){const{items:t}=this.state;for(let r=0;r<t.length;r++)if(t[r].id===e){if(t.length>r+1)return t[r+1].id;if(t.length===r+1&&0!==r)return t[r-1].id}return-1}find(e){return this.state.items.find((t=>t.id===e))}findByUrl(e){return this.state.items.find((t=>t.url===encodeURI(e)))}getNodeDocuments(){return this.state.items.filter((e=>"nodes"===e.kind))}getSshDocuments(){return this.state.items.filter((e=>"terminal"===e.kind&&"connected"===e.status))}getDocuments(){return this.state.items}}class Ut extends u.y{constructor(){var e,t;super(...arguments),t={},(e="state")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t}setParties(e){this.setState(e)}bySid(e){return this.state[e]||[]}}function Ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(r),!0).forEach((function(t){$t(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ft(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ht=St.Z.create("teleport/console"),qt=Le.g.getTracer("console-context");class Kt{constructor(){$t(this,"storeDocs",new Bt),$t(this,"storeParties",new Ut),$t(this,"nodesService",new Nt.Z),this.storeDocs.add({kind:"blank",url:B.Z.getConsoleRoute(B.Z.proxyCluster),clusterId:B.Z.proxyCluster,created:new Date})}getActiveDocId(e){const t=this.storeDocs.findByUrl(e);return t?t.id:-1}removeDocument(e){const t=this.storeDocs.getNext(e),r=this.storeDocs.filter(e);return this.storeDocs.setState({items:r}),this.storeDocs.find(t)}updateSshDocument(e,t){this.storeDocs.update(e,t)}addNodeDocument(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B.Z.proxyCluster;return this.storeDocs.add({clusterId:e,title:"New session",kind:"nodes",url:B.Z.getConsoleNodesRoute(e),created:new Date})}addSshDocument(e){let{login:t,serverId:r,sid:n,clusterId:o}=e;const s=t&&r?`${t}@${r}`:n,i=this.getSshDocumentUrl({clusterId:o,login:t,serverId:r,sid:n});return this.storeDocs.add({kind:"terminal",status:"disconnected",clusterId:o,title:s,serverId:r,login:t,sid:n,url:i,created:new Date})}getDocuments(){return this.storeDocs.state.items}getNodeDocumentUrl(e){return B.Z.getConsoleNodesRoute(e)}getSshDocumentUrl(e){return e.sid?B.Z.getSshSessionRoute(e):B.Z.getSshConnectRoute(e)}refreshParties(){return qt.startActiveSpan("refreshParties",(e=>{const t=this.storeDocs.getSshDocuments().filter((e=>"connected"===e.status)).map((e=>e.clusterId)),r=[...new Set(t)].map((e=>At.Z.fetchParticipants({clusterId:e}).catch((e=>(Ht.error("failed to refresh participants",e),{})))));return Promise.all(r).then((t=>{let r={};for(let e=0;e<t.length;e++)r=Mt({},t[e]);this.storeParties.setParties(r),e.end()}))}))}fetchNodes(e,t){return this.nodesService.fetchNodes(e,t).then((e=>({nodesRes:e})))}fetchClusters(){return Zt.Z.fetchClusters()}createTty(e){const{login:t,sid:r,serverId:n,clusterId:o}=e,s=new _t.jf;let i={};const a=Be.D.active();s.inject(a,i,Pt.M);const c=B.Z.api.ttyWsAddr.replace(":fqdn",(0,Me.Lp)()).replace(":token",(0,Me.hP)()).replace(":clusterId",o).replace(":traceparent",i.traceparent),l=new It({ttyUrl:c,ttyParams:{login:t,sid:r,server_id:n}});return new kt.Z(l)}gotoNodeTab(e){const t=this.getNodeDocumentUrl(e);this.gotoTab({url:t})}gotoTab(e){let{url:t}=e;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?it.Z.push(t):it.Z.replace(t)}closeTab(e){const t=this.removeDocument(e.id);this.gotoTab(t)}}function Wt(){const[e]=n.useState((()=>new Kt));return n.createElement(p,{value:e},n.createElement(Et,null))}},4523:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(2784),o=r(9161),s=r(9124),i=r(7849);const a=function(e){let{onContinue:t,onCancel:r,errorText:a}=e;return n.createElement(o.ZP,{dialogCss:()=>({width:"400px"}),open:!0},n.createElement(o.fK,{style:{flexDirection:"column"}},n.createElement(o.$N,{textAlign:"center"},"Verify Your Identity")),n.createElement(o.cZ,{mb:6},a&&n.createElement(s.b0,{mt:2,width:"100%"},a),n.createElement(i.xv,{textAlign:"center"},"Re-authentication is required. Follow the prompts given by your browser to complete authentication.")),n.createElement(o.cN,{textAlign:"center"},n.createElement(i.DF,{onClick:t,mr:3,width:"130px"},a?"Retry":"Verify"),n.createElement(i.PL,{onClick:r},"Cancel")))}},8082:(e,t,r)=>{r.d(t,{j:()=>o});var n=r(2699);class o extends n.EventEmitter{constructor(){super()}sendWebAuthn(e){throw new Error("Not implemented")}}},3094:(e,t,r)=>{var n,o,s;r.d(t,{Jr:()=>s,dw:()=>o,tw:()=>n}),function(e){e.START="session.start",e.JOIN="session.join",e.END="session.end",e.PRINT="print",e.RESIZE="resize"}(n||(n={})),function(e){e.RESIZE="terminal.resize",e.CLOSE="terminal.close",e.RESET="terminal.reset",e.SESSION="terminal.new_session",e.DATA="terminal.data",e.CONN_CLOSE="connection.close",e.WEBAUTHN_CHALLENGE="terminal.webauthn"}(o||(o={})),function(e){e[e.NORMAL=1e3]="NORMAL"}(s||(s={}))},6209:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(3363),o=r.n(n),s=r(4073),i=r.n(s),a=(r(3886),r(2320)),c=r(2617),l=r(2418),u=r(3094);function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p=l.Z.create("lib/term/terminal");class f{constructor(e,t){d(this,"term",void 0),d(this,"tty",void 0),d(this,"_el",void 0),d(this,"_scrollBack",void 0),d(this,"_fontFamily",void 0),d(this,"_fontSize",void 0),d(this,"_debouncedResize",void 0),d(this,"_fitAddon",new c.FitAddon);const{el:r,scrollBack:n,fontFamily:o,fontSize:s}=t;this._el=r,this._fontFamily=o||void 0,this._fontSize=s||14,this._scrollBack=n,this.tty=e,this.term=null,this._debouncedResize=i()((()=>{this._requestResize()}),200)}open(){this.term=new a.Terminal({lineHeight:1,fontFamily:this._fontFamily,fontSize:this._fontSize,scrollback:this._scrollBack||1e3,cursorBlink:!1,allowTransparency:!0}),this.term.loadAddon(this._fitAddon),this.term.open(this._el),this._fitAddon.fit(),this.term.focus(),this.term.onData((e=>{this.tty.send(e)})),this.tty.on(u.dw.RESET,(()=>this.reset())),this.tty.on(u.dw.CONN_CLOSE,(e=>this._processClose(e))),this.tty.on(u.dw.DATA,(e=>this._processData(e))),this.tty.on(u.dw.RESIZE,(e=>{let{h:t,w:r}=e;return this.resize(r,t)})),this.connect(),window.addEventListener("resize",this._debouncedResize)}connect(){this.tty.connect(this.term.cols,this.term.rows)}destroy(){var e;this._disconnect(),this._debouncedResize.cancel(),this._fitAddon.dispose(),this._el.innerHTML=null,null===(e=this.term)||void 0===e||e.dispose(),window.removeEventListener("resize",this._debouncedResize)}reset(){this.term.reset()}resize(e,t){try{if(o()(e)&&o()(t)||(e=this.term.cols,t=this.term.rows),e===this.term.cols&&t===this.term.rows)return;this.term.resize(e,t)}catch(r){p.error("xterm.resize",{w:e,h:t},r),this.term.reset()}}_disconnect(){this.tty.disconnect(),this.tty.removeAllListeners()}_requestResize(){this._el.clientWidth&&this._el.clientHeight?(this._fitAddon.fit(),this.tty.requestResize(this.term.cols,this.term.rows)):p.info("unable to resize terminal (container might be hidden)")}_processData(e){try{this.tty.pauseFlow(),this.term.write(e,(()=>this.tty.resumeFlow()))}catch(t){p.error("xterm.write",e,t),this.term.reset(),this.tty.resumeFlow()}}_processClose(e){const{reason:t}=e;let r="disconnected";t&&(r=`${r}: ${t}`),r=`[31m${r}[m\r\n`,this.term.write(r)}}},8005:(e,t,r)=>{r.d(t,{Z:()=>g});var n=r(2418),o=r(8082),s=r(3094),i=r(8834);const a={RAW:"r",AUDIT:"a",SESSION_DATA:"s",SESSION_END:"c",RESIZE:"w",WEBAUTHN_CHALLENGE:"n"},c={payload:{code:26},version:{code:10,length:1,values:{v1:49}},type:{length:1,code:18,values:{resize:a.RESIZE.charCodeAt(0),data:a.RAW.charCodeAt(0),event:a.AUDIT.charCodeAt(0),close:a.SESSION_END.charCodeAt(0)}}};class l{encode(e,t){var r=[];return this.encodeVersion(r),this.encodeType(r,e),this.encodePayload(r,t),r}encodeResizeMessage(e){return this.encode(c.type.values.resize,e)}encodeRawMessage(e){return this.encode(c.type.values.data,e)}encodePayload(e,t){e.push(c.payload.code);var r=this._textToUintArray(t);this.encodeVarint(e,r.length);for(var n=0;n<r.length;n++)e.push(r[n])}encodeVersion(e){e[0]=c.version.code,e[1]=c.version.length,e[2]=c.version.values.v1}encodeType(e,t){e[3]=c.type.code,e[4]=c.type.length,e[5]=t}encodeVarint(e,t){for(var r=t>>>0,n=Math.floor((t-r)/4294967296)>>>0;n>0||r>127;)e.push(127&r|128),r=(r>>>7|n<<25)>>>0,n>>>=7;e.push(r)}decode(e){return{version:this.decodeVersion(e),type:this.decodeType(e),payload:this.decodePayload(e)}}decodeVersion(e){if(e[0]===c.version.code&&e[1]===c.version.length)return String.fromCharCode(e[2]);throw new Error("invalid version field")}decodeType(e){if(e[3]===c.type.code&&e[4]===c.type.length)return String.fromCharCode(e[5]);throw new Error("invalid type field")}decodePayload(e){if(!e[6])return"";if(e[6]!==c.payload.code)throw new Error("invalid payload field");const t=e.slice(7),[r,n]=this.decodeVarint(t),o=t.slice(r,r+n);return this._uintArrayToText(o)}decodeVarint(e){let t=0,r=0;for(let o=0;o<e.length;o++){var n=e[o];if(n<128){if(o>9||9==o&&n>1)throw new Error("unable to decode varint: overflow");return[o+1,t|n<<r]}t|=n&127<<r,r+=7}throw new Error("unable to decode varint: empty array")}_textToUintArray(e){return i.Buffer(e)}_uintArrayToText(e){return window.TextDecoder?new TextDecoder("utf-8").decode(e):i.Buffer(e).toString()}}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice});const f=n.Z.create("Tty"),h={buffered:!0};class m extends o.j{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),p(this,"socket",null),p(this,"_buffered",!0),p(this,"_attachSocketBufferTimer",void 0),p(this,"_attachSocketBuffer",void 0),p(this,"_addressResolver",null),p(this,"_proto",new l);const r=d(d({},h),t);this._addressResolver=e,this._buffered=r.buffered,this._onOpenConnection=this._onOpenConnection.bind(this),this._onCloseConnection=this._onCloseConnection.bind(this),this._onMessage=this._onMessage.bind(this)}disconnect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.Jr.NORMAL;null!==this.socket&&this.socket.close(e)}connect(e,t){const r=this._addressResolver.getConnStr(e,t);this.socket=new WebSocket(r),this.socket.binaryType="arraybuffer",this.socket.onopen=this._onOpenConnection,this.socket.onmessage=this._onMessage,this.socket.onclose=this._onCloseConnection}send(e){if(!this.socket||!e)return;const t=this._proto.encodeRawMessage(e),r=new Uint8Array(t);this.socket.send(r.buffer)}sendWebAuthn(e){this.send(JSON.stringify(e))}pauseFlow(){}resumeFlow(){}requestResize(e,t){if(this.socket){f.info("requesting new screen size",`w:${e} and h:${t}`);var r=JSON.stringify({event:s.tw.RESIZE,width:e,height:t,size:`${e}:${t}`}),n=this._proto.encodeResizeMessage(r),o=new Uint8Array(n);this.socket.send(o.buffer)}}_flushBuffer(){this.emit(s.dw.DATA,this._attachSocketBuffer),this._attachSocketBuffer=null,clearTimeout(this._attachSocketBufferTimer),this._attachSocketBufferTimer=null}_pushToBuffer(e){this._attachSocketBuffer?this._attachSocketBuffer+=e:(this._attachSocketBuffer=e,setTimeout(this._flushBuffer.bind(this),10))}_onOpenConnection(){this.emit("open"),f.info("websocket is open")}_onCloseConnection(e){this.socket.onopen=null,this.socket.onmessage=null,this.socket.onclose=null,this.socket=null,this.emit(s.dw.CONN_CLOSE,e),f.info("websocket is closed")}_onMessage(e){try{const t=new Uint8Array(e.data),r=this._proto.decode(t);switch(r.type){case a.WEBAUTHN_CHALLENGE:this.emit(s.dw.WEBAUTHN_CHALLENGE,r.payload);break;case a.AUDIT:this._processAuditPayload(r.payload);break;case a.SESSION_DATA:this.emit(s.dw.SESSION,r.payload);break;case a.SESSION_END:this.emit(s.dw.CLOSE,r.payload);break;case a.RAW:this._buffered?this._pushToBuffer(r.payload):this.emit(s.dw.DATA,r.payload);break;default:throw Error(`unknown message type: ${r.type}`)}}catch(e){f.error("failed to parse incoming message.",e)}}_processAuditPayload(e){const t=JSON.parse(e);if(t.event===s.tw.RESIZE){let[e,r]=t.size.split(":");e=Number(e),r=Number(r),this.emit(s.dw.RESIZE,{w:e,h:r})}}}const g=m},2070:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(2784),o=r(3094),s=r(9376);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){const[t,r]=(0,n.useState)({requested:!1,errorText:"",publicKey:null}),i=e=>{const n=JSON.parse(e),o=(0,s.ee)(n).webauthnPublicKey;r(a(a({},t),{},{requested:!0,publicKey:o}))};return(0,n.useEffect)((()=>{if(e)return e.on(o.dw.WEBAUTHN_CHALLENGE,i),()=>{e.removeListener(o.dw.WEBAUTHN_CHALLENGE,i)}}),[e]),{errorText:t.errorText,requested:t.requested,authenticate:function(){if(window.PublicKeyCredential)navigator.credentials.get({publicKey:t.publicKey}).then((n=>{const o=(0,s.oH)(n);e.sendWebAuthn(o),r(a(a({},t),{},{requested:!1,errorText:""}))})).catch((e=>{r(a(a({},t),{},{errorText:e.message}))}));else{const e="This browser does not support WebAuthn required for hardware tokens,       please try the latest version of Chrome, Firefox or Safari.";r(a(a({},t),{},{errorText:e}))}},setState:r}}},5849:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(2784),o=r(1581);function s(){const e=n.useContext(o.B);if(!e)throw new Error("Unable to retrieve WebSession Context");return e}}}]);