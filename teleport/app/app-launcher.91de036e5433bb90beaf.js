"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[202],{4696:(t,e,a)=>{a.d(e,{Z:()=>r});var s=a(2784);const n=a(2418).Z.create("shared/hooks/useAttempt");function r(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const[e,a]=s.useState((()=>({status:t,statusText:""})));function r(t){n.error("attempt",t),a({status:"failed",statusText:t.message})}const o=(0,s.useCallback)((t=>{try{return a({status:"processing"}),t().then((()=>(a({status:"success"}),!0))).catch((t=>(r(t),!1)))}catch(t){return r(t),Promise.resolve(!1)}}),[]);return{attempt:e,setAttempt:a,run:o,handleError:r}}},8118:(t,e,a)=>{a.r(e),a.d(e,{default:()=>l});var s=a(2784),n=a(4517),r=a(1218),o=a(8851),c=a(4696),u=a(3022);function l(){const{attempt:t,setAttempt:e}=(0,c.Z)("processing"),a=(0,n.UO)(),{search:r}=(0,n.TH)(),o=new URLSearchParams(r),l=(0,s.useCallback)((async t=>{try{let e=t.fqdn;e||(e=(await u.Z.getAppFqdn(t)).fqdn);const a=location.port?`:${location.port}`:"",s=await u.Z.createAppSession(t);await fetch(`https://${e}${a}/x-teleport-auth`,{method:"POST",credentials:"include",headers:{"X-Cookie-Value":s.cookieValue,"X-Subject-Cookie-Value":s.subjectCookieValue}});let n="";o.has("path")&&(n=decodeURIComponent(o.get("path")),n.startsWith("/")||(n=`/${n}`)),window.location.replace(`https://${e}${a}${n}`)}catch(t){let a="Something went wrong";t instanceof Error&&(a=t.message),e({status:"failed",statusText:a})}}),[]);return(0,s.useEffect)((()=>{l(a)}),[a]),"failed"===t.status?s.createElement(p,{statusText:t.statusText}):s.createElement(i,null)}function i(){return s.createElement(r.kC,{height:"180px",justifyContent:"center",alignItems:"center",flex:"1"},s.createElement(r.z$,null))}function p(t){return s.createElement(o.JK,{message:t.statusText})}}}]);