"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[58],{5070:(e,t,a)=>{function r(e){return navigator.clipboard.writeText(e).catch((e=>{window.prompt("Cannot copy to clipboard. Use ctrl/cmd + c",e)}))}a.d(t,{Z:()=>r})},3388:(e,t,a)=>{function r(e){let t,a;window.getSelection&&document.createRange&&(a=window.getSelection(),t=document.createRange(),t.selectNodeContents(e),a.removeAllRanges(),a.addRange(t))}a.d(t,{Z:()=>r})},5208:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var r=a(2784),n=a(7849),s=a(2398),o=a(7067),c=a(5769),l=a(2499),i=a(2479),u=a(3652),p=a(9161),m=a(1347);const d=function(e){let{username:t,dbName:a,onClose:s,authType:o,accessRequestId:c}=e;const{hostname:l,port:i}=window.document.location,u=`${l}:${i||"443"}`,d="sso"===o?`tsh login --proxy=${u}`:`tsh login --proxy=${u} --auth=local --user=${t}`,b=c?` --request-id=${c}`:"";return r.createElement(p.ZP,{dialogCss:()=>({maxWidth:"600px",width:"100%"}),disableEscapeKeyDown:!1,onClose:s,open:!0},r.createElement(p.fK,{mb:4},r.createElement(p.$N,null,"Connect To Database")),r.createElement(p.cZ,{minHeight:"240px",flex:"0 0 auto"},r.createElement(n.xu,{mb:4},r.createElement(n.xv,{bold:!0,as:"span"},"Step 1")," - Login to Teleport",r.createElement(m.Z,{mt:"2",text:`${d}${b}`})),r.createElement(n.xu,{mb:4},r.createElement(n.xv,{bold:!0,as:"span"},"Step 2")," - Retrieve credentials for the database",r.createElement(m.Z,{mt:"2",text:`tsh db login [--db-user=<user>] [--db-name=<name>] ${a}`})),r.createElement(n.xu,{mb:4},r.createElement(n.xv,{bold:!0,as:"span"},"Step 3")," - Connect to the database",r.createElement(m.Z,{mt:"2",text:`tsh db connect [--db-user=<user>] [--db-name=<name>] ${a}`})),c&&r.createElement(n.xu,{mb:4},r.createElement(n.xv,{bold:!0,as:"span"},"Step 4 (Optional)")," - When finished, drop the assumed role",r.createElement(m.Z,{mt:"2",text:"tsh request drop"})),r.createElement(n.xu,null,"* Note: To connect with a GUI database client, see our ",r.createElement(n.rU,{href:"https://goteleport.com/docs/database-access/guides/gui-clients/",target:"_blank"},"documentation")," for instructions.")),r.createElement(p.cN,null,r.createElement(n.PL,{onClick:s},"Close")))};var b=a(8388);const h=function(e){const{databases:t=[],pageSize:a,username:s,clusterId:o,authType:c,totalCount:l,fetchNext:i,fetchPrev:p,fetchStatus:m,from:h,to:f,params:g,setParams:y,startKeys:x,setSort:E,pathname:v,replaceHistory:C,onLabelClick:w,accessRequestId:S}=e,[P,O]=(0,r.useState)(null);return r.createElement(r.Fragment,null,r.createElement(u.ZP,{data:t,columns:[{key:"name",headerText:"Name",isSortable:!0},{key:"description",headerText:"Description",isSortable:!0},{key:"type",headerText:"Type",isSortable:!0},{key:"labels",headerText:"Labels",render:e=>{let{labels:t}=e;return r.createElement(u.aW,{labels:t,onClick:w})}},{altKey:"connect-btn",render:e=>function(e,t){let{name:a,protocol:s}=e;return r.createElement(u.bL,{align:"right"},r.createElement(n.ku,{size:"small",onClick:()=>{t({name:a,protocol:s})}},"Connect"))}(e,O)}],pagination:{pageSize:a},fetching:{onFetchNext:i,onFetchPrev:p,fetchStatus:m},serversideProps:{sort:g.sort,setSort:E,startKeys:x,serversideSearchPanel:r.createElement(b.Z,{from:h,to:f,count:l,params:g,setParams:y,pathname:v,replaceHistory:C})},isSearchable:!0,emptyText:"No Databases Found"}),P&&r.createElement(d,{username:s,clusterId:o,dbName:P.name,dbProtocol:P.protocol,onClose:()=>O(null),authType:c,accessRequestId:S}))};var f=a(4517),g=a(4696),y=a(321),x=a(6828),E=a(1392),v=a(7773);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function P(e){const{attempt:t,isLeafCluster:a,canCreate:s,username:u,clusterId:p,authType:m,results:d,fetchNext:b,fetchPrev:f,from:g,to:y,pageSize:x,params:E,setParams:v,startKeys:C,setSort:w,pathname:S,replaceHistory:P,fetchStatus:k,isSearchEmpty:Z,onLabelClick:j,accessRequestId:T}=e,D=0===d.databases.length&&Z;return r.createElement(o.Ob,null,r.createElement(o.OX,{alignItems:"center",justifyContent:"space-between"},r.createElement(o.u4,null,"Databases"),"success"===t.status&&!D&&r.createElement(i.Z,{agent:"database",beginsWithVowel:!1,isLeafCluster:a,canCreate:s})),"processing"===t.status&&r.createElement(n.xu,{textAlign:"center",m:10},r.createElement(n.z$,null)),"failed"===t.status&&r.createElement(l.Z,{message:t.statusText}),"processing"!==t.status&&!D&&r.createElement(h,{databases:d.databases,username:u,clusterId:p,authType:m,fetchNext:b,fetchPrev:f,fetchStatus:k,from:g,to:y,totalCount:d.totalCount,pageSize:x,params:E,setParams:v,startKeys:C,setSort:w,pathname:S,replaceHistory:P,onLabelClick:j,accessRequestId:T}),"success"===t.status&&D&&r.createElement(c.Z,{clusterId:p,canCreate:s&&!a,emptyStateInfo:O}))}const O={title:"Add your first database to Teleport",byline:"Teleport Database Access provides secure access to PostgreSQL, MySQL, MariaDB, MongoDB, Redis, and Microsoft SQL Server.",docsURL:"https://goteleport.com/docs/database-access/guides/",resourceType:"database",readOnly:{title:"No Databases Found",resource:"databases"}},k=function(){const e=function(e){const{search:t,pathname:a}=(0,f.TH)(),[n,s]=(0,r.useState)([]),{attempt:o,setAttempt:c}=(0,g.Z)("processing"),{clusterId:l,isLeafCluster:i}=(0,x.Z)(),u=e.storeUser.state.username,p=e.storeUser.getTokenAccess().create,m=e.storeUser.state.authType,d=e.storeUser.getAccessRequestId(),[b,h]=(0,r.useState)(""),[C,S]=(0,r.useState)(w({sort:{fieldName:"name",dir:"ASC"}},(0,y.Z)(t))),P=!(null!=C&&C.query||null!=C&&C.search),[O,k]=(0,r.useState)({databases:[],startKey:"",totalCount:0}),Z=O.totalCount>0?15*(n.length-2)+1:0,j=O.totalCount>0?Z+O.databases.length-1:0;function T(e){E.Z.replace(e)}return(0,r.useEffect)((()=>{c({status:"processing"}),e.databaseService.fetchDatabases(l,w(w({},C),{},{limit:15})).then((e=>{k({databases:e.agents,startKey:e.startKey,totalCount:e.totalCount}),h(e.startKey?"":"disabled"),s(["",e.startKey]),c({status:"success"})})).catch((e=>{c({status:"failed",statusText:e.message}),k(w(w({},O),{},{databases:[],totalCount:0})),s([""])}))}),[l,t]),{attempt:o,canCreate:p,isLeafCluster:i,username:u,clusterId:l,authType:m,results:O,fetchNext:()=>{h("loading"),e.databaseService.fetchDatabases(l,w(w({},C),{},{limit:15,startKey:O.startKey})).then((e=>{k(w(w({},O),{},{databases:e.agents,startKey:e.startKey})),h(e.startKey?"":"disabled"),s([...n,e.startKey])})).catch((e=>{c({status:"failed",statusText:e.message})}))},fetchPrev:()=>{h("loading"),e.databaseService.fetchDatabases(l,w(w({},C),{},{limit:15,startKey:n[n.length-3]})).then((e=>{const t=n;t.pop(),s(t),k(w(w({},O),{},{databases:e.agents,startKey:e.startKey})),h("")})).catch((e=>{c({status:"failed",statusText:e.message})}))},pageSize:15,from:Z,to:j,params:C,setParams:S,startKeys:n,setSort:function(e){S(w(w({},C),{},{sort:e}))},pathname:a,replaceHistory:T,fetchStatus:b,isSearchEmpty:P,onLabelClick:e=>(0,v.Z)(e,C,S,a,T),accessRequestId:d}}((0,s.Z)());return r.createElement(P,e)}},2479:(e,t,a)=>{a.d(t,{Z:()=>c});var r=a(2784),n=a(7933),s=a(7849),o=a(7278);const c=function(e){const{canCreate:t,isLeafCluster:a,onClick:c,agent:l,beginsWithVowel:i}=e,u=a||!t;let p="";return t||(p=`You do not have access to add ${i?"an":"a"} ${l}`),a&&(p=`Adding ${i?"an":"a"} ${l} to a leaf cluster is not supported`),r.createElement(n.rU,{to:{pathname:`${o.Z.routes.root}/discover`,state:{entity:l}},style:{textDecoration:"none"}},r.createElement(s.DF,{title:p,disabled:u,width:"240px",onClick:c},"Add ",l))}},5769:(e,t,a)=>{a.d(t,{Z:()=>d});var r=a(2784),n=a(7933),s=a(7849),o=a(9049),c=a(7278);const l=a.p+"assets/img/img-b7a4b8.png",i=a.p+"assets/img/img-6693d4.png",u=a.p+"assets/img/img-7ba430.png",p=a.p+"assets/img/img-73fbbf.png";function m(e){return{application:l,database:i,desktop:u,kubernetes:p,server:p}[e]}const d=function(e){const{canCreate:t,clusterId:a,emptyStateInfo:l}=e,{byline:i,docsURL:u,resourceType:p,readOnly:d,title:b}=l;return t?r.createElement(s.xu,{p:8,pt:5,as:s.kC,width:"100%",mx:"auto",alignItems:"center",justifyContent:"center"},r.createElement(s.xu,{maxWidth:600},r.createElement(s.xu,{mb:4,textAlign:"center"},r.createElement(o.Z,{src:m(p),ml:"auto",mr:"auto",mb:4,height:"160px"}),r.createElement(s.xv,{typography:"h5",mb:2,fontWeight:700,fontSize:24},b),r.createElement(s.xv,{fontWeight:400,fontSize:14,style:{opacity:"0.6"}},i)),r.createElement(s.xu,{textAlign:"center"},r.createElement(n.rU,{to:{pathname:`${c.Z.routes.root}/discover`,state:{entity:p}},style:{textDecoration:"none"}},r.createElement(s.DF,{width:"224px"},"Add ",p)),r.createElement(s.JU,{size:"medium",as:"a",href:u,target:"_blank",width:"224px",ml:4,rel:"noreferrer"},"View Documentation")))):r.createElement(s.xu,{p:8,mx:"auto",maxWidth:"664px",textAlign:"center",color:"text.primary",borderRadius:"12px"},r.createElement(s.xv,{typography:"h2",mb:"3"},d.title),r.createElement(s.xv,null,"Either there are no ",d.resource,' in the "',r.createElement(s.xv,{as:"span",bold:!0},a),"\" cluster, or your roles don't grant you access."))}},7067:(e,t,a)=>{a.d(t,{Ob:()=>p,OX:()=>i,u4:()=>u,E2:()=>m});var r=a(917),n=a(7849),s=a(135);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const i=(0,r.ZP)(n.kC)(["flex-shrink:0;border-bottom:1px solid ",";height:56px;margin-left:-40px;margin-right:-40px;padding-left:40px;padding-right:40px;"],(e=>e.theme.colors.primary.main));i.defaultProps={alignItems:"center",mb:4};const u=(0,r.ZP)(n.xv)(["white-space:nowrap;"]);u.defaultProps=c(c({},n.xv.defaultProps),{},{typography:"h3"});const p=(0,r.ZP)(n.kC)(["width:100%;height:100%;flex-direction:column;::after{content:' ';padding-bottom:24px;}"]);p.defaultProps={theme:s.Z,px:6},r.ZP.div(["position:absolute;width:100%;height:100%;display:flex;"]),r.ZP.div(["display:flex;flex-direction:column;width:100%;"]);const m=r.ZP.button(["color:",";cursor:pointer;display:inline-flex;font-size:14px;padding:12px 40px;position:relative;text-decoration:none;font-weight:500;&:hover{background:",";}&.active{color:",";}&.active:after{background-color:",";content:'';position:absolute;bottom:0;left:0;width:100%;height:4px;}"],(e=>e.theme.colors.text.secondary),(e=>e.active?e.theme.colors.primary.light:"rgba(255, 255, 255, .06)"),(e=>e.theme.colors.light),(e=>e.theme.colors.accent))},1347:(e,t,a)=>{a.d(t,{r:()=>p,Z:()=>y});var r=a(2784),n=a(5070),s=a(3388),o=a(7849),c=a(917);const l=["text","fontFamily","allowMultiline","onCopy","bash"];function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},i.apply(this,arguments)}var u=a(3757);function p(e){var t,a;let{lines:c,bash:l=!0}=e;const i=(0,r.useRef)([]),p=null===(t=window.navigator)||void 0===t||null===(a=t.userAgent)||void 0===a?void 0:a.toLowerCase().includes("firefox");return r.createElement(f,{bg:"bgTerminal",pl:3,pt:2,pr:7,borderRadius:2,pb:p?3:2},r.createElement(h,{mr:1},c.map(((e,t)=>{const a=t===c.length-1;return r.createElement(o.xu,{pt:2,pb:a?0:2,key:t,ref:e=>i.current[t]=e},e.comment&&r.createElement(d,null,e.comment),r.createElement(o.kC,null,r.createElement(o.kC,null,l&&r.createElement(o.xu,{mr:"1"},"$"),r.createElement("div",{className:"text-to-copy"},e.text)),r.createElement(g,{pr:3},r.createElement(b,{onClick:()=>function(e){(0,n.Z)(c[e].text).then((()=>{const t=i.current[e].getElementsByClassName("icon-container")[0];t.classList.toggle("copied"),setTimeout((()=>{t.classList.toggle("copied")}),1e3)}));const t=i.current[e].getElementsByClassName("text-to-copy")[0];(0,s.Z)(t)}(t)},r.createElement(m,{className:"icon-container"},r.createElement(u.CKM,{"data-testid":"btn-copy"}),r.createElement(u.JrY,{"data-testid":"btn-check"}))))))}))))}const m=c.ZP.div([".icon-check{display:none;}.icon-copy{display:block;}&.copied{.icon-check{display:block;}.icon-copy{display:none;}}"]),d=c.ZP.div(["color:rgb(117 113 94 / 80%);"]),b=(0,c.ZP)(o.PL)(["height:28px;width:28px;border-radius:20px;min-height:auto;padding:0;margin-top:-4px;"]),h=(0,c.ZP)(o.xu)(["white-space:pre;word-break:break-all;font-size:12px;font-family:",";overflow:scroll;line-height:20px;"],(e=>{let{theme:t}=e;return t.fonts.mono}));var f=(0,c.ZP)(o.xu)({position:"relative"}),g=(0,c.ZP)(o.xu)(["position:absolute;right:0px;"]);const y=function(e){let{text:t,fontFamily:a,allowMultiline:u,onCopy:p,bash:m=!0}=e,d=function(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,l);const b=a||(0,c.Fg)().fonts.mono,h=r.useRef(),[f,g]=r.useState((()=>"Copy")),y=m&&!u?{overflow:"auto",whiteSpace:"pre",wordBreak:"break-all",fontSize:"12px",fontFamily:b}:{wordBreak:"break-all",fontSize:"12px",fontFamily:b};return r.createElement(o.kC,i({bg:"bgTerminal",p:"2",alignItems:"center",justifyContent:"space-between",borderRadius:2},d),r.createElement(o.kC,{mr:"2",style:y},m&&r.createElement(o.xu,{mr:"1",style:{userSelect:"none"}},"$"),r.createElement("div",{ref:h},t)),r.createElement(o.DF,{onClick:function(){(0,n.Z)(t).then((()=>g("Copied"))),(0,s.Z)(h.current),p&&p()},style:{maxWidth:"48px",width:"100%",padding:"4px 8px",minHeight:"10px",fontSize:"10px"}},f))}}}]);