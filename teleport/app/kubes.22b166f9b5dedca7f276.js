"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[384],{5070:(e,t,n)=>{function r(e){return navigator.clipboard.writeText(e).catch((e=>{window.prompt("Cannot copy to clipboard. Use ctrl/cmd + c",e)}))}n.d(t,{Z:()=>r})},3388:(e,t,n)=>{function r(e){let t,n;window.getSelection&&document.createRange&&(n=window.getSelection(),t=document.createRange(),t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t))}n.d(t,{Z:()=>r})},7225:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var r=n(2784),a=n(7849),s=n(3652),o=n(8388),c=n(9161),l=n(1347),i=n(3228);const u=()=>"\n  min-height: 400px;\n  max-width: 600px;\n  width: 100%;\n",p=function(e){const{onClose:t,username:n,authType:s,kubeConnectName:o,clusterId:p,accessRequestId:m}=e;return r.createElement(c.ZP,{dialogCss:u,disableEscapeKeyDown:!1,onClose:t,open:!0},r.createElement(c.fK,null,r.createElement(c.$N,null,"connect to kubernetes cluster")),r.createElement(c.cZ,null,r.createElement(a.xu,{mb:4},r.createElement(a.xv,{bold:!0,as:"span"},"Step 1")," - Login to Teleport",r.createElement(l.Z,{mt:"2",text:(0,i.Sl)({authType:s,username:n,clusterId:p})})),r.createElement(a.xu,{mb:4},r.createElement(a.xv,{bold:!0,as:"span"},"Optional")," ","- To write kubectl configuration to a separate file instead of having your global kubectl configuration modified, run the following command:",r.createElement(l.Z,{mt:"2",text:"export KUBECONFIG=${HOME?}/teleport-kubeconfig.yaml"})),r.createElement(a.xu,{mb:4},r.createElement(a.xv,{bold:!0,as:"span"},"Step 2")," - Select the Kubernetes cluster",r.createElement(l.Z,{mt:"2",text:`tsh kube login ${o}`})),r.createElement(a.xu,{mb:1},r.createElement(a.xv,{bold:!0,as:"span"},"Step 3")," - Connect to the Kubernetes cluster",r.createElement(l.Z,{mt:"2",text:"kubectl get pods"})),m&&r.createElement(a.xu,{mb:1,mt:3},r.createElement(a.xv,{bold:!0,as:"span"},"Step 4 (Optional)")," - When finished, drop the assumed role",r.createElement(l.Z,{mt:"2",text:"tsh request drop"}))),r.createElement(c.cN,null,r.createElement(a.PL,{onClick:t},"Close")))},m=function(e){const{kubes:t=[],pageSize:n,username:c,authType:l,clusterId:i,totalCount:u,fetchNext:m,fetchPrev:d,fetchStatus:b,from:h,to:f,params:g,setParams:y,startKeys:x,setSort:E,pathname:v,replaceHistory:k,onLabelClick:C,accessRequestId:w}=e,[S,O]=(0,r.useState)("");return r.createElement(r.Fragment,null,r.createElement(s.ZP,{data:t,columns:[{key:"name",headerText:"Name",isSortable:!0},{key:"labels",headerText:"Labels",render:e=>{let{labels:t}=e;return r.createElement(s.aW,{labels:t,onClick:C})}},{altKey:"connect-btn",render:e=>((e,t)=>{let{name:n}=e;return r.createElement(s.bL,{align:"right"},r.createElement(a.ku,{size:"small",onClick:()=>t(n)},"Connect"))})(e,O)}],fetching:{onFetchNext:m,onFetchPrev:d,fetchStatus:b},serversideProps:{sort:g.sort,setSort:E,startKeys:x,serversideSearchPanel:r.createElement(o.Z,{from:h,to:f,count:u,params:g,setParams:y,pathname:v,replaceHistory:k})},isSearchable:!0,emptyText:"No Kubernetes Clusters Found",pagination:{pageSize:n}}),S&&r.createElement(p,{onClose:()=>O(""),username:c,authType:l,kubeConnectName:S,clusterId:i,accessRequestId:w}))};var d=n(7067),b=n(5769),h=n(2499),f=n(2398),g=n(2479),y=n(4517),x=n(4696),E=n(1392),v=n(6828),k=n(321),C=n(7773);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){const{attempt:t,username:n,authType:s,isLeafCluster:o,clusterId:c,canCreate:l,results:i,fetchNext:u,fetchPrev:p,from:f,to:y,pageSize:x,params:E,setParams:v,startKeys:k,setSort:C,pathname:w,replaceHistory:S,fetchStatus:O,isSearchEmpty:P,onLabelClick:K,accessRequestId:j}=e,T=0===i.kubes.length&&P;return r.createElement(d.Ob,null,r.createElement(d.OX,{alignItems:"center",justifyContent:"space-between"},r.createElement(d.u4,null,"Kubernetes"),"success"===t.status&&!T&&r.createElement(g.Z,{agent:"kubernetes",beginsWithVowel:!1,isLeafCluster:o,canCreate:l})),"failed"===t.status&&r.createElement(h.Z,{message:t.statusText}),"processing"===t.status&&r.createElement(a.xu,{textAlign:"center",m:10},r.createElement(a.z$,null)),"processing"!==t.status&&!T&&r.createElement(m,{kubes:i.kubes,username:n,authType:s,clusterId:c,fetchNext:u,fetchPrev:p,fetchStatus:O,from:f,to:y,totalCount:i.totalCount,pageSize:x,params:E,setParams:v,startKeys:k,setSort:C,pathname:w,replaceHistory:S,onLabelClick:K,accessRequestId:j}),"success"===t.status&&T&&r.createElement(b.Z,{clusterId:c,canCreate:l&&!o,emptyStateInfo:Z}))}const Z={title:"Add your first Kubernetes cluster to Teleport",byline:"Teleport Kubernetes Access provides secure access to Kubernetes clusters.",docsURL:"https://goteleport.com/docs/kubernetes-access/guides",resourceType:"kubernetes",readOnly:{title:"No Kubernetes Clusters Found",resource:"kubernetes clusters"}},K=function(){const e=function(e){const{clusterId:t,isLeafCluster:n}=(0,v.Z)(),{username:a,authType:s}=e.storeUser.state,{search:o,pathname:c}=(0,y.TH)(),[l,i]=(0,r.useState)([]),u=e.storeUser.getTokenAccess().create,p=e.storeUser.getAccessRequestId(),{attempt:m,setAttempt:d}=(0,x.Z)("processing"),[b,h]=(0,r.useState)(""),[f,g]=(0,r.useState)(S({sort:{fieldName:"name",dir:"ASC"}},(0,k.Z)(o))),w=!(null!=f&&f.query||null!=f&&f.search),[O,P]=(0,r.useState)({kubes:[],startKey:"",totalCount:0}),Z=O.totalCount>0?15*(l.length-2)+1:0,K=O.totalCount>0?Z+O.kubes.length-1:0;function j(e){E.Z.replace(e)}return(0,r.useEffect)((()=>{d({status:"processing"}),e.kubeService.fetchKubernetes(t,S(S({},f),{},{limit:15})).then((e=>{P({kubes:e.agents,startKey:e.startKey,totalCount:e.totalCount}),h(e.startKey?"":"disabled"),i(["",e.startKey]),d({status:"success"})})).catch((e=>{d({status:"failed",statusText:e.message}),P(S(S({},O),{},{kubes:[],totalCount:0})),i([""])}))}),[t,o]),{attempt:m,username:a,authType:s,isLeafCluster:n,clusterId:t,canCreate:u,results:O,fetchNext:()=>{h("loading"),e.kubeService.fetchKubernetes(t,S(S({},f),{},{limit:15,startKey:O.startKey})).then((e=>{P(S(S({},O),{},{kubes:e.agents,startKey:e.startKey})),h(e.startKey?"":"disabled"),i([...l,e.startKey])})).catch((e=>{d({status:"failed",statusText:e.message})}))},fetchPrev:()=>{h("loading"),e.kubeService.fetchKubernetes(t,S(S({},f),{},{limit:15,startKey:l[l.length-3]})).then((e=>{const t=l;t.pop(),i(t),P(S(S({},O),{},{kubes:e.agents,startKey:e.startKey})),h("")})).catch((e=>{d({status:"failed",statusText:e.message})}))},pageSize:15,from:Z,to:K,params:f,setParams:g,startKeys:l,setSort:function(e){g(S(S({},f),{},{sort:e}))},pathname:c,replaceHistory:j,fetchStatus:b,isSearchEmpty:w,onLabelClick:e=>(0,C.Z)(e,f,g,c,j),accessRequestId:p}}((0,f.Z)());return r.createElement(P,e)}},2479:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(2784),a=n(7933),s=n(7849),o=n(7278);const c=function(e){const{canCreate:t,isLeafCluster:n,onClick:c,agent:l,beginsWithVowel:i}=e,u=n||!t;let p="";return t||(p=`You do not have access to add ${i?"an":"a"} ${l}`),n&&(p=`Adding ${i?"an":"a"} ${l} to a leaf cluster is not supported`),r.createElement(a.rU,{to:{pathname:`${o.Z.routes.root}/discover`,state:{entity:l}},style:{textDecoration:"none"}},r.createElement(s.DF,{title:p,disabled:u,width:"240px",onClick:c},"Add ",l))}},5769:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(2784),a=n(7933),s=n(7849),o=n(9049),c=n(7278);const l=n.p+"assets/img/img-b7a4b8.png",i=n.p+"assets/img/img-6693d4.png",u=n.p+"assets/img/img-7ba430.png",p=n.p+"assets/img/img-73fbbf.png";function m(e){return{application:l,database:i,desktop:u,kubernetes:p,server:p}[e]}const d=function(e){const{canCreate:t,clusterId:n,emptyStateInfo:l}=e,{byline:i,docsURL:u,resourceType:p,readOnly:d,title:b}=l;return t?r.createElement(s.xu,{p:8,pt:5,as:s.kC,width:"100%",mx:"auto",alignItems:"center",justifyContent:"center"},r.createElement(s.xu,{maxWidth:600},r.createElement(s.xu,{mb:4,textAlign:"center"},r.createElement(o.Z,{src:m(p),ml:"auto",mr:"auto",mb:4,height:"160px"}),r.createElement(s.xv,{typography:"h5",mb:2,fontWeight:700,fontSize:24},b),r.createElement(s.xv,{fontWeight:400,fontSize:14,style:{opacity:"0.6"}},i)),r.createElement(s.xu,{textAlign:"center"},r.createElement(a.rU,{to:{pathname:`${c.Z.routes.root}/discover`,state:{entity:p}},style:{textDecoration:"none"}},r.createElement(s.DF,{width:"224px"},"Add ",p)),r.createElement(s.JU,{size:"medium",as:"a",href:u,target:"_blank",width:"224px",ml:4,rel:"noreferrer"},"View Documentation")))):r.createElement(s.xu,{p:8,mx:"auto",maxWidth:"664px",textAlign:"center",color:"text.primary",borderRadius:"12px"},r.createElement(s.xv,{typography:"h2",mb:"3"},d.title),r.createElement(s.xv,null,"Either there are no ",d.resource,' in the "',r.createElement(s.xv,{as:"span",bold:!0},n),"\" cluster, or your roles don't grant you access."))}},7067:(e,t,n)=>{n.d(t,{Ob:()=>p,OX:()=>i,u4:()=>u,E2:()=>m});var r=n(917),a=n(7849),s=n(135);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const i=(0,r.ZP)(a.kC)(["flex-shrink:0;border-bottom:1px solid ",";height:56px;margin-left:-40px;margin-right:-40px;padding-left:40px;padding-right:40px;"],(e=>e.theme.colors.primary.main));i.defaultProps={alignItems:"center",mb:4};const u=(0,r.ZP)(a.xv)(["white-space:nowrap;"]);u.defaultProps=c(c({},a.xv.defaultProps),{},{typography:"h3"});const p=(0,r.ZP)(a.kC)(["width:100%;height:100%;flex-direction:column;::after{content:' ';padding-bottom:24px;}"]);p.defaultProps={theme:s.Z,px:6},r.ZP.div(["position:absolute;width:100%;height:100%;display:flex;"]),r.ZP.div(["display:flex;flex-direction:column;width:100%;"]);const m=r.ZP.button(["color:",";cursor:pointer;display:inline-flex;font-size:14px;padding:12px 40px;position:relative;text-decoration:none;font-weight:500;&:hover{background:",";}&.active{color:",";}&.active:after{background-color:",";content:'';position:absolute;bottom:0;left:0;width:100%;height:4px;}"],(e=>e.theme.colors.text.secondary),(e=>e.active?e.theme.colors.primary.light:"rgba(255, 255, 255, .06)"),(e=>e.theme.colors.light),(e=>e.theme.colors.accent))},1347:(e,t,n)=>{n.d(t,{r:()=>p,Z:()=>y});var r=n(2784),a=n(5070),s=n(3388),o=n(7849),c=n(917);const l=["text","fontFamily","allowMultiline","onCopy","bash"];function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}var u=n(3757);function p(e){var t,n;let{lines:c,bash:l=!0}=e;const i=(0,r.useRef)([]),p=null===(t=window.navigator)||void 0===t||null===(n=t.userAgent)||void 0===n?void 0:n.toLowerCase().includes("firefox");return r.createElement(f,{bg:"bgTerminal",pl:3,pt:2,pr:7,borderRadius:2,pb:p?3:2},r.createElement(h,{mr:1},c.map(((e,t)=>{const n=t===c.length-1;return r.createElement(o.xu,{pt:2,pb:n?0:2,key:t,ref:e=>i.current[t]=e},e.comment&&r.createElement(d,null,e.comment),r.createElement(o.kC,null,r.createElement(o.kC,null,l&&r.createElement(o.xu,{mr:"1"},"$"),r.createElement("div",{className:"text-to-copy"},e.text)),r.createElement(g,{pr:3},r.createElement(b,{onClick:()=>function(e){(0,a.Z)(c[e].text).then((()=>{const t=i.current[e].getElementsByClassName("icon-container")[0];t.classList.toggle("copied"),setTimeout((()=>{t.classList.toggle("copied")}),1e3)}));const t=i.current[e].getElementsByClassName("text-to-copy")[0];(0,s.Z)(t)}(t)},r.createElement(m,{className:"icon-container"},r.createElement(u.CKM,{"data-testid":"btn-copy"}),r.createElement(u.JrY,{"data-testid":"btn-check"}))))))}))))}const m=c.ZP.div([".icon-check{display:none;}.icon-copy{display:block;}&.copied{.icon-check{display:block;}.icon-copy{display:none;}}"]),d=c.ZP.div(["color:rgb(117 113 94 / 80%);"]),b=(0,c.ZP)(o.PL)(["height:28px;width:28px;border-radius:20px;min-height:auto;padding:0;margin-top:-4px;"]),h=(0,c.ZP)(o.xu)(["white-space:pre;word-break:break-all;font-size:12px;font-family:",";overflow:scroll;line-height:20px;"],(e=>{let{theme:t}=e;return t.fonts.mono}));var f=(0,c.ZP)(o.xu)({position:"relative"}),g=(0,c.ZP)(o.xu)(["position:absolute;right:0px;"]);const y=function(e){let{text:t,fontFamily:n,allowMultiline:u,onCopy:p,bash:m=!0}=e,d=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,l);const b=n||(0,c.Fg)().fonts.mono,h=r.useRef(),[f,g]=r.useState((()=>"Copy")),y=m&&!u?{overflow:"auto",whiteSpace:"pre",wordBreak:"break-all",fontSize:"12px",fontFamily:b}:{wordBreak:"break-all",fontSize:"12px",fontFamily:b};return r.createElement(o.kC,i({bg:"bgTerminal",p:"2",alignItems:"center",justifyContent:"space-between",borderRadius:2},d),r.createElement(o.kC,{mr:"2",style:y},m&&r.createElement(o.xu,{mr:"1",style:{userSelect:"none"}},"$"),r.createElement("div",{ref:h},t)),r.createElement(o.DF,{onClick:function(){(0,a.Z)(t).then((()=>g("Copied"))),(0,s.Z)(h.current),p&&p()},style:{maxWidth:"48px",width:"100%",padding:"4px 8px",minHeight:"10px",fontSize:"10px"}},f))}},3228:(e,t,n)=>{n.d(t,{ES:()=>o,Kp:()=>a,RB:()=>r,Sl:()=>s});const r=e=>{const t=document.createElement("a");t.setAttribute("href",`${e}`),t.setAttribute("target","_blank"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)};async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new TextEncoder;const n=t.encode(e),r=await crypto.subtle.digest("SHA-256",n),a=Array.from(new Uint8Array(r)),s=a.map((e=>e.toString(16).padStart(2,"0"))).join("");return s}function s(e){let{authType:t,clusterId:n,username:r,accessRequestId:a}=e;const{hostname:s,port:o}=window.location;return`tsh login --proxy=${s}:${o||"443"} ${"local"===t?`--auth=${t} --user=${r} `:""}${n}${a?` --request-id=${a}`:""}`}function o(e,t){return e.filter((e=>!t.includes(e)))}}}]);