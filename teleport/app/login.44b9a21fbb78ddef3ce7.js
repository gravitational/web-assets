"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[535],{1271:(e,t,r)=>{r.d(t,{Z:()=>m});var n=r(917),o=r(2784),a=r(7849),l=r(8197),c=r(7038);const i=["label","labelTip","value","options","onChange","placeholder","maxMenuHeight","isClearable","isMulti","menuPosition","rule","isSearchable","isSimpleValue","autoFocus","isDisabled"];function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}const u=()=>()=>({valid:!0}),d=e=>{let{text:t}=e;return o.createElement(p,null,` - ${t}`)};var p=(0,n.ZP)("span")({fontWeight:"normal",textTransform:"none"});const m=function(e){let{label:t,labelTip:r,value:n,options:p,onChange:m,placeholder:b,maxMenuHeight:h,isClearable:g,isMulti:f,menuPosition:y,rule:E=u,isSearchable:x=!1,isSimpleValue:v=!1,autoFocus:w=!1,isDisabled:P=!1}=e,_=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,i);const{valid:k,message:O}=(0,l.kQ)(E(n)),Z=Boolean(!k),S=Z?O:t;return o.createElement(a.xu,s({mb:"4"},_),t&&o.createElement(a.SO,{htmlFor:"select",hasError:Z},S,r&&o.createElement(d,{text:r})),o.createElement(c.ZP,{inputId:"select",menuPosition:y,hasError:Z,isSimpleValue:v,isSearchable:x,isClearable:g,value:n,onChange:m,options:p,maxMenuHeight:h,placeholder:b,isMulti:f,autoFocus:w,isDisabled:P}))}},7038:(e,t,r)=>{r.d(t,{vf:()=>b,qV:()=>p,ZP:()=>h});var n=r(2784),o=r(4711),a=r(7308),l=r(917),c=r(2865);const i=["hasError"],s=["hasError"];function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u.apply(this,arguments)}function d(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function p(e){const{hasError:t=!1}=e,r=d(e,s);return n.createElement(m,{hasError:t},n.createElement(a.ZP,u({className:"react-select-container",classNamePrefix:"react-select",clearable:!1,isSearchable:!0,defaultOptions:!1,cacheOptions:!1,defaultMenuIsOpen:!1,placeholder:"Select..."},r)))}const m=l.ZP.div([".react-select-container{box-shadow:inset 0 2px 4px rgba(0,0,0,0.24);box-sizing:border-box;border:none;display:block;font-size:14px;outline:none;width:100%;color:rgba(0,0,0,0.87);background-color:#ffffff;margin-bottom:0px;border-radius:4px;}.react-select__control,.react-select__control--is-focused{min-height:40px;height:40px;background-color:transparent;border-color:transparent;border-radius:4px;border-style:solid;border-width:1px;box-shadow:none;"," &:hover{border-color:transparent;cursor:pointer;}}.react-select__option{&:hover{cursor:pointer;background-color:#eceff1;}}.react-select__option--is-focused{background-color:#eceff1;}.react-select__option--is-selected{background-color:#cfd8dc;color:inherit;&:hover{background-color:#cfd8dc;}}.react-select__menu{margin-top:0px;}.react-select__indicator-separator{display:none;}.react-select__loading-indicator{display:none;}.react-select--is-disabled{.react-select__single-value,.react-select__placeholder{color:rgba(0,0,0,0.24);}.react-select__indicator{color:rgba(0,0,0,0.14);}}"," ",""],(e=>{let{hasError:t,theme:r}=e;if(t)return{borderRadius:"inherit !important",borderWidth:"2px !important",border:`2px solid ${r.colors.error.main}  !important`}}),c.bf,c.Dh),b=(0,l.ZP)(m)((e=>{let{theme:t}=e;return`\n  .react-select-container {\n    background: transparent;\n  }\n\n  .react-select__option--is-focused:active {\n    background-color: ${t.colors.grey[50]};\n  }\n  \n  .react-select__value-container {\n    padding: 0 8px;\n  }\n\n  .react-select__single-value {\n    color: ${t.colors.text.primary}\n  }\n\n  \n  .react-select__control {\n    min-height: 34px;\n    height: 34px;\n    border-color: rgba(255, 255, 255, 0.24);\n    color: ${t.colors.text.secondary};\n\n    &:focus, &:active {\n      background-color: ${t.colors.primary.lighter};\n    }\n\n    &:hover {\n      border-color: rgba(255, 255, 255, 0.24);\n      background-color: ${t.colors.primary.lighter};\n      .react-select__dropdown-indicator {\n        color: #666;\n      }\n    }\n\n    .react-select__indicator,\n    .react-select__dropdown-indicator {\n      padding: 4px 8px;\n      color: #666;\n      &:hover {\n        color: #999;\n      }\n    }\n  }\n\n  .react-select__control--menu-is-open {\n    background-color: ${t.colors.primary.lighter};\n    border-color: transparent;\n    border-radius: 4px;\n    border-style: solid;\n    border-width: 1px;\n    box-shadow: none;\n    border-color: rgba(255, 255, 255, 0.24);\n\n    .react-select__indicator,\n    .react-select__dropdown-indicator {\n      color: #999 !important;\n      &:hover {\n        color: #ccc !important;\n      }\n    }\n  }\n\n  .react-select__input {\n    color: ${t.colors.text.primary}\n  }\n\n  .react-select__placeholder {\n    color: ${t.colors.text.secondary}\n  }\n\n  .react-select__option {\n    padding: 4px 12px;\n  } \n\n  .react-select__menu {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n  }\n\n  .react-select__multi-value {\n    background-color: ${t.colors.primary.dark};\n    border: 1px solid ${t.colors.text.placeholder};\n  }\n\n  .react-select__multi-value__label {\n    color: ${t.colors.text.primary};\n    padding: 0 6px;\n  }\n\n  .react-select--is-disabled {\n    .react-select__single-value,\n    .react-select__placeholder,\n    .react-select__indicator {\n      color: ${t.colors.text.placeholder};\n    }\n  }\n`})),h=function(e){const{hasError:t=!1}=e,r=d(e,i);return n.createElement(m,{hasError:t},n.createElement(o.ZP,u({menuPlacement:"auto",className:"react-select-container",classNamePrefix:"react-select",clearable:!1,isMulti:!1,isSearchable:!0,placeholder:"Select..."},r)))}},778:(e,t,r)=>{r.r(t),r.d(t,{LoginFailed:()=>s,default:()=>i});var n=r(2784),o=r(8851),a=r(7885),l=r(4116),c=r(7278);function i(){return n.createElement(a.rs,null,n.createElement(a.AW,{path:c.Z.routes.loginErrorCallback},n.createElement(s,{message:"unable to process callback"})),n.createElement(a.AW,{path:c.Z.routes.loginErrorUnauthorized},n.createElement(s,{message:"You are not authorized, please contact your SSO administrator."})),n.createElement(a.AW,{component:s}))}function s(e){let{message:t}=e;return n.createElement(n.Fragment,null,n.createElement(l.Z,null),n.createElement(o.Jz,{loginUrl:c.Z.routes.login,message:t||"unable to login, please check Teleport's log for details"}))}},402:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r(2784),o=r(7849),a=r(4116);function l(){return n.createElement(n.Fragment,null,n.createElement(a.Z,null),n.createElement(o.Pk,null))}},8998:(e,t,r)=>{r.r(t),r.d(t,{LoginFailed:()=>V.default,LoginSuccess:()=>q.default,default:()=>Y});var n=r(2784),o=r(917),a=r(7849),l=r(3757),c=r(9124),i=r(9127),s=r(8197),u=r(2030),d=r(1271),p=r(7097),m=r(9750),b=r(5081),h=r(2966),g=r(8227),f=r(9537);const y=["ssoType","title"];function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E.apply(this,arguments)}function x(e){switch(e.toLowerCase()){case"microsoft":return{color:"#2672ec",Icon:l.deu,type:e};case"github":return{color:"#444444",Icon:l.Eye,type:e};case"bitbucket":return{color:"#205081",Icon:l.Dzp,type:e};case"google":return{color:"#dd4b39",Icon:l.ieO,type:e};default:return{color:"#f7931e",Icon:l.mRU}}}const v=(0,o.ZP)(g.ZP)(["background-color:",";display:block;width:100%;border:1px solid transparent;&:hover,&:focus{background:",";border:1px solid ",";}height:40px;position:relative;box-sizing:border-box;","{font-size:20px;opacity:0.87;}"],(e=>e.color),(e=>(0,f._j)(e.color,.1)),(e=>(0,f.$n)(e.color,.4)),l.ZPm),w=o.ZP.div(["align-items:center;display:flex;justify-content:center;position:absolute;left:0;top:0;bottom:0;width:56px;font-size:24px;text-align:center;border-right:1px solid rgba(0,0,0,0.12);"]),P=e=>{const{ssoType:t="unknown",title:r}=e,o=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,y),{color:a,Icon:l}=x(t);return n.createElement(v,E({color:a,block:!0},o),Boolean(l)&&n.createElement(w,null,n.createElement(l,{"data-testid":"icon"})),r)},_=e=>{let{providers:t,prefixText:r,isDisabled:o,onClick:l,autoFocus:c=!1}=e;const i=t.map(((e,a)=>{let{name:i,type:s,displayName:u}=e;const d=u||`${r} ${i}`,p=function(){let e=arguments.length>1?arguments[1]:void 0;const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase();return-1!==t.indexOf("microsoft")?"microsoft":-1!==t.indexOf("bitbucket")?"bitbucket":-1!==t.indexOf("google")?"google":-1!==t.indexOf("github")||"github"===e?"github":"oidc"===e?"openid":"unknown"}(d,s),m=t.length-1;return n.createElement(P,{key:a,title:d,ssoType:p,disabled:o,mt:3,mb:a<m?3:0,autoFocus:0===a&&c,onClick:t=>{t.preventDefault(),l(e)}})}));return 0===i.length?n.createElement(a.xv,{textAlign:"center",bold:!0,pt:3},"You have no SSO providers configured"):n.createElement(a.xu,{px:6,pt:2,pb:2,"data-testid":"sso-list"},i)},k=["next","refCallback","hasTransitionEnded"],O=["prev","refCallback"];function Z(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function S(){return S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S.apply(this,arguments)}const C=e=>{let{attempt:t,authProviders:r,onLoginWithSso:o,autoFocus:a=!1}=e;const{isProcessing:l}=t;return n.createElement(_,{prefixText:"Login with",isDisabled:l,providers:r,onClick:o,autoFocus:a})},F=e=>{var t,r;let{onLoginWithWebauthn:o,attempt:i,autoFocus:s=!1}=e;const u=null===(t=window.navigator)||void 0===t||null===(r=t.userAgent)||void 0===r?void 0:r.toLowerCase().includes("firefox");return n.createElement(a.xu,{px:5,pt:2,"data-testid":"passwordless",pb:1},u&&n.createElement(c.kI,{mt:3},"Firefox may not support passwordless login. Please try Chrome or Safari."),n.createElement(j,{mt:3,py:2,px:3,width:"100%",onClick:()=>o(),disabled:i.isProcessing,autoFocus:s},n.createElement(a.kC,{alignItems:"center",justifyContent:"space-between"},n.createElement(a.kC,{alignItems:"center"},n.createElement(l.srI,{mr:3,fontSize:16}),n.createElement(a.xu,null,n.createElement(a.xv,{typography:"h6"},"Passwordless"),n.createElement(a.xv,{fontSize:1,color:"text.secondary"},"Follow the prompt from your browser"))),n.createElement(l.ZJY,{fontSize:16}))))},T=e=>{let{isRecoveryEnabled:t,onRecover:r,auth2faType:o,attempt:l,onLogin:c,onLoginWithWebauthn:b,clearAttempt:h,hasTransitionEnded:g,autoFocus:f=!1}=e;const{isProcessing:y}=l,[E,x]=(0,n.useState)(""),[v,w]=(0,n.useState)(""),[P,_]=(0,n.useState)(""),k=(0,n.useMemo)((()=>(0,m.Z)({auth2faType:o})),[]),O=(0,i.U7)({shouldFocus:g&&f}),[Z,S]=(0,n.useState)(k[0]);return n.createElement(s.ZP,null,(e=>{let{validator:l}=e;return n.createElement(a.kC,{as:"form",px:"5",pt:"3",justifyContent:"center",flexDirection:"column",borderBottomLeftRadius:"3",borderBottomRightRadius:"3","data-testid":"userpassword"},n.createElement(u.Z,{ref:O,rule:(0,p.lp)("Username is required"),label:"Username",value:v,onChange:e=>w(e.target.value),placeholder:"Username",mb:3}),n.createElement(a.xu,{mb:t?1:3},n.createElement(u.Z,{rule:(0,p.lp)("Password is required"),label:"Password",value:E,onChange:e=>x(e.target.value),type:"password",placeholder:"Password",mb:0,width:"100%"}),t&&n.createElement(a.xu,{textAlign:"right"},n.createElement(a.ZP,{style:{padding:"0px",minHeight:0},onClick:()=>r(!0)},"Forgot Password?"))),"off"!==o&&n.createElement(a.xu,{mb:t?2:3},n.createElement(a.kC,{alignItems:"flex-end"},n.createElement(d.Z,{maxWidth:"50%",width:"100%","data-testid":"mfa-select",label:"Two-factor type",value:Z,options:k,onChange:e=>function(e,t){_(""),h(),t.reset(),S(e)}(e,l),mr:3,mb:0,isDisabled:y,menuIsOpen:!0}),"otp"===Z.value&&n.createElement(u.Z,{width:"50%",label:"Authenticator code",rule:p.Sb,autoComplete:"one-time-code",inputMode:"numeric",value:P,onChange:e=>_(e.target.value),placeholder:"123 456",mb:0})),t&&n.createElement(a.ZP,{style:{padding:"0px",minHeight:0},onClick:()=>r(!1)},"Lost Two-Factor Device?")),n.createElement(a.DF,{width:"100%",mt:3,mb:1,type:"submit",size:"large",onClick:e=>function(e,t){e.preventDefault(),t.validate()&&("webauthn"===(null==Z?void 0:Z.value)?b({username:v,password:E}):c(v,E,P))}(e,l),disabled:y},"Sign In"))}))},A=()=>n.createElement(a.kC,{alignItems:"center",justifyContent:"center",flexDirection:"column",borderBottom:1,borderColor:"text.placeholder",mx:5,mt:5,mb:2},n.createElement(L,null,"Or")),j=(0,o.ZP)(a.oD)(["display:block;text-align:left;border:1px solid ",";&:hover,&:active,&:focus{border-color:",";text-decoration:none;}&[disabled]{pointer-events:none;opacity:0.7;}"],(e=>{let{theme:t}=e;return t.colors.text.placeholder}),(e=>{let{theme:t}=e;return t.colors.action.active})),L=o.ZP.div(["background:",";display:flex;align-items:center;font-size:10px;height:32px;width:32px;justify-content:center;position:absolute;z-index:1;"],(e=>e.theme.colors.primary.light)),W={default:[e=>{var t;let{next:r,refCallback:o,hasTransitionEnded:l}=e,c=Z(e,k);const i=(null===(t=c.authProviders)||void 0===t?void 0:t.length)>0;let s,u=!0;switch(c.primaryAuthType){case"passwordless":s=n.createElement(F,S({},c,{autoFocus:!0}));break;case"sso":s=n.createElement(C,S({},c,{autoFocus:!0}));break;case"local":u=c.isPasswordlessEnabled||i,s=n.createElement(T,S({},c,{hasTransitionEnded:l,autoFocus:!0}))}return n.createElement(a.xu,{ref:o},s,u&&n.createElement(a.xu,{pt:3,mt:-1,textAlign:"center"},n.createElement(a.oD,{disabled:c.attempt.isProcessing,onClick:()=>{c.clearAttempt(),r()}},"Other sign-in options")))},e=>{var t;let{prev:r,refCallback:o}=e,l=Z(e,O);const c=(null===(t=l.authProviders)||void 0===t?void 0:t.length)>0,{primaryAuthType:i,isPasswordlessEnabled:s}=l;let u;switch(i){case"passwordless":u=c?n.createElement(n.Fragment,null,n.createElement(C,S({},l,{autoFocus:!0})),n.createElement(A,null),n.createElement(T,l)):n.createElement(T,S({},l,{autoFocus:!0}));break;case"sso":u=s?n.createElement(n.Fragment,null,n.createElement(F,S({},l,{autoFocus:!0})),n.createElement(A,null),n.createElement(T,l)):n.createElement(T,S({},l,{autoFocus:!0}));break;case"local":u=s?n.createElement(n.Fragment,null,n.createElement(F,S({},l,{autoFocus:!0})),l.isPasswordlessEnabled&&c&&n.createElement(A,null),c&&n.createElement(C,l)):n.createElement(C,S({},l,{autoFocus:!0}))}return n.createElement(a.xu,{ref:o},u,n.createElement(a.xu,{pt:3,textAlign:"center"},n.createElement(a.oD,{disabled:l.attempt.isProcessing,onClick:()=>{l.clearAttempt(),r()}},"Back")))}]},I=function(e){const{title:t,attempt:r,isLocalAuthEnabled:o=!0,authProviders:l=[],privateKeyPolicyEnabled:i,isRecoveryEnabled:s,onRecover:u}=e;if(i)return n.createElement(h.n,{title:t,onRecover:s?u:null});const d=(null==l?void 0:l.length)>0;return!o&&d?n.createElement(a.Zb,{bg:"primary.light",my:"5",mx:"auto",width:"464px",pb:4},n.createElement(a.xv,{typography:"h3",pt:4,textAlign:"center",color:"light"},t),r.isFailed&&n.createElement(c.b0,{m:5,mb:0},r.message),n.createElement(C,e)):o?n.createElement(a.Zb,{bg:"primary.light",my:"5",mx:"auto",width:464,pb:4},n.createElement(a.xv,{typography:"h3",pt:4,textAlign:"center",color:"light"},t),r.isFailed&&n.createElement(c.b0,{m:5,mb:0},r.message),n.createElement(b.z,S({flows:W,currFlow:"default"},e))):n.createElement(a.Zb,{bg:"primary.light",my:"5",mx:"auto",width:"464px",px:5,pb:4},n.createElement(a.xv,{typography:"h3",pt:4,textAlign:"center",color:"light"},t),n.createElement(c.b0,{my:5},"Login has not been enabled"),n.createElement(a.xv,{mb:2,typography:"paragraph2",width:"100%"},"The ability to login has not been enabled. Please contact your system administrator for more information."))};var D=r(4116);const $=["hardware_key","hardware_key_touch"];function z(e){return $.some((t=>e.message.includes(t)))}var M=r(1392),R=r(7278),U=r(9376);function B(){localStorage.clear(),sessionStorage.clear();const e=K();M.Z.push(e,!0)}function K(){let e=M.Z.getRedirectParam();return e=e?M.Z.ensureKnownRoute(e):R.Z.routes.root,M.Z.ensureBaseUrl(e)}const H=r(2010);function N(e){let{attempt:t,onLogin:r,onLoginWithWebauthn:o,onLoginWithSso:a,authProviders:l,auth2faType:c,preferredMfaType:i,isLocalAuthEnabled:s,clearAttempt:u,isPasswordlessEnabled:d,primaryAuthType:p,privateKeyPolicyEnabled:m}=e;return n.createElement(n.Fragment,null,n.createElement(D.Z,{src:H}),n.createElement(I,{title:"Sign in to Teleport",authProviders:l,auth2faType:c,preferredMfaType:i,isLocalAuthEnabled:s,onLoginWithSso:a,onLoginWithWebauthn:o,onLogin:r,attempt:t,clearAttempt:u,isPasswordlessEnabled:d,primaryAuthType:p,privateKeyPolicyEnabled:m}))}var V=r(778),q=r(402);const Y=function(){const e=function(){const[e,t]=(0,i.tg)({isProcessing:!1}),[r,o]=(0,n.useState)("none"!=R.Z.getPrivateKeyPolicy()),a=R.Z.getAuthProviders(),l=R.Z.getAuth2faType(),c=R.Z.getLocalAuthFlag();return{attempt:e,onLogin:function(e,r,n){t.start(),U.ZP.login(e,r,n).then(B).catch((e=>{z(e)?o(!0):t.error(e)}))},onLoginWithSso:function(e){t.start();const r=K(),n=R.Z.getSsoUrl(e.url,e.name,r);M.Z.push(n,!0)},authProviders:a,auth2faType:l,preferredMfaType:R.Z.getPreferredMfaType(),isLocalAuthEnabled:c,onLoginWithWebauthn:function(e){t.start(),U.ZP.loginWithWebauthn(e).then(B).catch((e=>{z(e)?o(!0):t.error(e)}))},clearAttempt:t.clear,isPasswordlessEnabled:R.Z.isPasswordlessEnabled(),primaryAuthType:R.Z.getPrimaryAuthType(),privateKeyPolicyEnabled:r}}();return n.createElement(N,e)}}}]);